!function(DOC){function noop(){}function log(){}function getType(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?class2type[serialize.call(e)]||"object":typeof e}function isWindow(e){return rwindow.test(serialize.call(e))}function resetNumber(e,t,r){return e=e!==+e||e%1?r?t:0:0>e?-1*e>=t?0:e+t:e>t?t:e}function oneObject(e,t){"string"==typeof e&&(e=e.match(rword)||[]);for(var r={},n=void 0!==t?t:1,a=0,o=e.length;o>a;a++)r[e[a]]=n;return r}function drainQueue(){var e=handlerQueue.shift();e&&(e(),handlerQueue.length&&avalon.nextTick())}function isArrayLike(e){if(e&&"object"==typeof e){var t=e.length;if(+t===t&&!(t%1)&&t>=0)try{return{}.propertyIsEnumerable.call(e,"length")===!1?Array.isArray(e)||/^\s?function/.test(e.item||e.callee):!0}catch(r){return!0}}return!1}function generateID(){return"avalon"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function iterator(e,t,r){var n="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+r;return Function("fn,scope",n)}function fixContains(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1}function kernel(e){for(var t in e)if(ohasOwn.call(e,t)){var r=e[t];"function"==typeof kernel.plugins[t]?kernel.plugins[t](r):"object"==typeof kernel[t]?avalon.mix(kernel[t],r):kernel[t]=r}return this}function escapeRegExp(e){return(e+"").replace(rregexp,"\\$&")}function hyphen(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function camelize(e){return e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function parseData(val){var _eval=!1;(rparse.test(val)||+val+""===val)&&(_eval=!0);try{return _eval?eval("0,"+val):val}catch(e){return val}}function getWindow(e){return e.window&&e.document?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}function showHidden(e,t){if(e.offsetWidth<=0){if(rdisplayswap.test(cssHooks["@:get"](e,"display"))){var r={node:e};for(var n in cssShow)r[n]=e.style[n],e.style[n]=cssShow[n];t.push(r)}var a=e.parentNode;a&&1==a.nodeType&&showHidden(a,t)}}function getValType(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}function updateWithProxy(e,t,r){var n=withProxyPool[e];n&&n[t]&&(n[t].$val=r)}function updateModel(e,t,r){if("array"===r){var n=t.concat();return e.clear(),e.push.apply(e,n),e}var a=e[subscribers];withProxyPool[e.$id]&&(withProxyCount--,delete withProxyPool[e.$id]),a.forEach(function(e){e.rollback&&e.rollback()});var o=modelFactory(t);return rebindings[o.$id]=function(e){for(;e=a.shift();)!function(e){e.type&&avalon.nextTick(function(){bindingHandlers[e.type](e,e.vmodels)})}(e);delete rebindings[o.$id]},o}function loopModel(e,t,r,n,a,o,i){if(r[e]=t,n[e])return n[e]=t;if("$"===e.charAt(0)&&!i[e])return n[e]=t;var s=getType(t);if("function"===s)return n[e]=t;var l,c;if("object"===s&&"function"==typeof t.get&&Object.keys(t).length<=2){var u=t.set,d=t.get;l=function(t){var n=i.vmodel,a=r[e],o=a;if(!arguments.length)return avalon.openComputedCollect&&collectSubscribers(l),t=r[e]=d.call(n),isEqual(a,t)||(c=void 0,safeFire(n,e,t,o)),t;if(!stopRepeatAssign){if("function"==typeof u){var s=n.$events[e];n.$events[e]=[],u.call(n,t),n.$events[e]=s}isEqual(c,t)||(c=t,t=r[e]=d.call(n),withProxyCount&&updateWithProxy(n.$id,e,t),notifySubscribers(l),safeFire(n,e,t,o))}},l[subscribers]=[],o.push(l)}else if(l=function(t){var n,a=i.vmodel,o=r[e];if(!arguments.length)return collectSubscribers(l),l.$vmodel||o;if(!stopRepeatAssign&&!isEqual(o,t)){if(rchecktype.test(s)){var c=l.$vmodel=updateModel(l.$vmodel,t,s),u=rebindings[c.$id];u&&u(),withProxyCount&&updateWithProxy(a.$id,e,c),safeFire(a,e,c.$model,o),l[subscribers]=c[subscribers],r[e]=c.$model}else r[e]=t,n=!0,withProxyCount&&updateWithProxy(a.$id,e,t);notifySubscribers(l),n&&safeFire(a,e,t,o)}},l[subscribers]=[],rchecktype.test(s)){var p=t.$model?t:modelFactory(t,t);l.$vmodel=p,l[subscribers]=p[subscribers],r[e]=p.$model}else r[e]=t;a[e]=l}function modelFactory(e,t){if(Array.isArray(e)){var r=Collection(e);return r._add(e),r}if("number"==typeof e.nodeType)return e;var n={};t=t||{};for(var a,o={},i={},s=[],l=arguments[2]||{},c=e.$skipArray,u=0;a=skipProperties[u++];)delete e[a],i[a]=!0;if(Array.isArray(c))for(var a,u=0;a=c[u++];)i[a]=!0;for(var u in e)loopModel(u,e[u],t,i,o,s,l);n=defineProperties(n,descriptorFactory(o),i);for(var a in i)n[a]=i[a];l.vmodel=n,n.$model=t,n.$events={},n.$id=generateID(),n.$accessors=o,n[subscribers]=[];for(var u in Observable){var d=Observable[u];W3C||(d=d.bind(n)),n[u]=d}n.hasOwnProperty=function(e){return e in n.$model};for(var d,u=0;d=s[u++];)Registry[expose]=d,d(),collectSubscribers(d),delete Registry[expose];return n}function VBMediator(e,t,r){var n=e[t];return 3!==arguments.length?n():void n(r)}function registerSubscriber(e){Registry[expose]=e,avalon.openComputedCollect=!0;var t=e.evaluator;t?"duplex"===e.type?e.handler():e.handler(t.apply(0,e.args),e.element,e):e(),avalon.openComputedCollect=!1,delete Registry[expose]}function collectSubscribers(e){if(Registry[expose]){var t=e[subscribers];t&&avalon.Array.ensure(t,Registry[expose])}}function notifySubscribers(e){var t=e[subscribers];if(t&&t.length)for(var r,n=aslice.call(arguments,1),a=t.length;r=t[--a];){var o,i=r.element;i&&!avalon.contains(ifSanctuary,i)&&(o="number"==typeof i.sourceIndex?0===i.sourceIndex:!avalon.contains(root,i),o&&(t.splice(a,1),log("remove "+r.name))),"function"==typeof r?r.apply(0,n):r.getter?r.handler.apply(r,n):r.handler(r.evaluator.apply(0,r.args||[]),i,r)}}function checkScan(e,t){var r=0/0,n=setInterval(function(){var a=e.innerHTML;a===r?(clearInterval(n),t()):r=a},interval)}function scanTag(e,t,r){var n=e.getAttribute(prefix+"skip"),a=e.getAttributeNode(prefix+"important"),o=e.getAttributeNode(prefix+"controller");if("string"!=typeof n){if(r=a||o){var i=VMODELS[r.value];if(!i)return;t=r===a?[i]:[i].concat(t),e.removeAttribute(r.name)}scanAttr(e,t)}}function scanNodes(e,t){for(var r=e.firstChild;r;){var n=r.nextSibling;1===r.nodeType?scanTag(r,t):3===r.nodeType&&rexpr.test(r.nodeValue)&&scanText(r,t),r=n}}function scanText(e,t){var r=[],n=scanExpr(e.nodeValue);if(n.length){for(var a,o=0;a=n[o++];){var i=DOC.createTextNode(a.value);if(a.expr){var s=a.filters,l={type:"text",node:i,nodeType:3,value:a.value,filters:s};s&&-1!==s.indexOf("html")&&(avalon.Array.remove(s,"html"),l.type="html",l.replaceNodes=[i],s.length||delete r.filters),r.push(l)}documentFragment.appendChild(i)}e.parentNode.replaceChild(documentFragment,e),r.length&&executeBindings(r,t)}}function scanAttr(e,t){for(var r,n,a=getAttributes?getAttributes(e):e.attributes,o=[],i=0;n=a[i++];)if(n.specified&&(r=n.name.match(rmsAttr))){var s=r[1];if("function"==typeof bindingHandlers[s]){var l=r[2]||"",c={type:s,param:l,element:e,name:r[0],value:n.nodeValue,priority:s in priorityMap?priorityMap[s]:10*s.charCodeAt(0)+(Number(l)||0)};"if"==s&&"loop"==l&&(c.priority+=100),"widget"===s||"if"==s?o.push(c):t.length&&o.push(c)}}o.sort(function(e,t){return e.priority-t.priority});var u=o[0]||{};switch(u.type){case"if":return void bindingHandlers["if"](u,t);case"repeat":return u.vmodels=t,void bindingHandlers.repeat(u,t);default:executeBindings(o,t),!stopScan[e.tagName]&&rbind.test(e.innerHTML)&&scanNodes(e,t)}}function executeBindings(e,t){for(var r,n=0;r=e[n++];)r.vmodels=t,bindingHandlers[r.type](r,t),r.evaluator&&r.name&&r.element.removeAttribute(r.name);e.length=0}function scanExpr(e){for(var t,r,n=[],a=0;;){if(r=e.indexOf(openTag,a),-1===r)break;if(t=e.slice(a,r),t&&n.push({value:t,expr:!1}),a=r+openTag.length,r=e.indexOf(closeTag,a),-1===r)break;if(t=e.slice(a,r)){var o=[];t.indexOf("|")>0&&(t=t.replace(r11a,"U2hvcnRDaXJjdWl0"),t=t.replace(rfilters,function(e,t,r){return o.push(t+(r||"")),""}),t=t.replace(r11b,"||")),n.push({value:t,expr:!0,filters:o.length?o:void 0})}a=r+closeTag.length}return t=e.slice(a),t&&n.push({value:t,expr:!1}),n}function addAssign(e,t,r){for(var n=[],a=" = "+r+".",o=e.length;r=e[--o];)r=e[o],t.hasOwnProperty&&t.hasOwnProperty(r)&&(n.push(r+a+r),e.splice(o,1));return n}function uniqArray(e,t){var r=e.length;if(1>=r)return e;if(2===r)return e[0]!==e[1]?e:[e[0]];var n={};return e.filter(function(e){var r=t?e&&e.$id:e;return n[r]?!1:(n[r]=1,!0)})}function createCache(e){function t(n,a){return r.push(n)>e&&delete t[r.shift()],t[n]=a}var r=[];return t}function parseExpr(e,t,r,n){var a=t.map(function(e){return e.$id})+e+r.filters+(n||"");if("duplex"===n){var o=cacheExpr[a];if(o)return r.evaluator=o;o=Function("a","b","switch(arguments.length){\n case 2:\n	a."+e+" = b\n	break;\ncase 1:\n	return a."+e+";\n}")}else{var i=getVariables(e),s=[],l=[],c=[],u="";i=uniqArray(i),t=uniqArray(t,1);for(var d=0,p=t.length;p>d;d++)if(i.length){var f="vm"+expose+"_"+d;l.push(f),c.push(t[d]),s.push.apply(s,addAssign(i,t[d],f))}if(o=cacheExpr[a])return r.filters&&c.push(avalon.filters),r.evaluator=o,void(r.args=c);var u=s.join(", ");if(u&&(u="var "+u),"on"===r.type&&(e=-1===e.indexOf(".bind(")?e.replace("(",".call(this,"):e.replace(".bind(",".call("),"$event"===n&&l.push(n)),r.filters){e="\nvar ret"+expose+" = "+e;var v,h=[];h.push(e,"\r\n");for(var m,d=0;m=r.filters[d++];){var g=m.indexOf("(");-1!==g?(v=m.slice(g+1,m.lastIndexOf(")")).trim(),v=","+v,m=m.slice(0,g).trim()):v="",h.push(" if(filters",expose,".",m,"){\n	try{\nret",expose," = filters",expose,".",m,"(ret",expose,v,")\n	}catch(e){} \n}\n")}e=h.join(""),e+="\nreturn ret"+expose,l.push("filters"+expose),c.push(avalon.filters)}else e="\nreturn "+e+";";if("on"===r.type){var y=e.lastIndexOf("\nreturn"),b=e.slice(0,y),x=e.slice(y);e=b+"\nif(avalon.openComputedCollect) return ;"+x}try{o=Function.apply(Function,l.concat("'use strict';\n"+u+e))}catch(w){}}try{"on"!==r.type&&"duplex"!==n&&o.apply(o,c),cacheExpr(a,o),r.evaluator=o,r.args=c}catch(w){}finally{i=h=l=null}}function parseExprProxy(e,t,r,n){if(Array.isArray(n)){var a=n.map(function(e){var r={};return e.expr?parseExpr(e.value,t,r)||r:e.value});r.evaluator=function(){for(var e,t="",r=0;e=a[r++];)t+="string"==typeof e?e:e.evaluator.apply(0,e.args);return t},r.args=[]}else parseExpr(e,t,r,n);r.evaluator&&(r.handler=bindingExecutors[r.handlerName||r.type],r.evaluator.toString=function(){return r.type+" binding to eval("+e+")"},registerSubscriber(r))}function parseDisplay(e,t){if(e=e.toLowerCase(),!cacheDisplay[e]){var r=DOC.createElement(e);root.appendChild(r),t=window.getComputedStyle?window.getComputedStyle(r,null).display:r.currentStyle.display,root.removeChild(r),cacheDisplay[e]=t}return cacheDisplay[e]}function filterData(e,t){var r={};for(var n in e)0===n.indexOf(t)&&(r[n.replace(t,"").replace(/\w/,function(e){return e.toLowerCase()})]=e[n]);return r}function fixEvent(e){var t={};for(var r in e)t[r]=e[r];var n=t.target=e.srcElement;if(0===e.type.indexOf("key"))t.which=null!=e.charCode?e.charCode:e.keyCode;else if(/mouse|click/.test(e.type)){var a=n.ownerDocument||DOC,o="BackCompat"===a.compatMode?a.body:a.documentElement;t.pageX=e.clientX+(o.scrollLeft>>0)-(o.clientLeft>>0),t.pageY=e.clientY+(o.scrollTop>>0)-(o.clientTop>>0)}return t.timeStamp=new Date-0,t.originalEvent=e,t.preventDefault=function(){e.returnValue=!1},t.stopPropagation=function(){e.cancelBubble=!0},t}function convert(e){var t=getType(e);return rchecktype.test(t)&&(e=e.$id?e:modelFactory(e,e)),e}function getIndex(e,t,r){for(var n=r,a=t.length;a>n;n++)if(isEqual(e,t[n]))return n;return-1}function Collection(e){var t=[];t.$id=generateID(),t[subscribers]=[],t.$model=e.concat(),t.$events={},t._=modelFactory({length:e.length}),t._.$watch("length",function(e,r){t.$fire("length",e,r)});for(var r in Observable)t[r]=Observable[r];return avalon.mix(t,CollectionPrototype),t}function removeFromSanctuary(e){for(var t,r=queryComments(e),n=0;t=r[n++];)if("ms-if"==t.nodeValue){var a=t.elem;a.parentNode&&a.parentNode.removeChild(a)}e.textContent=""}function iteratorCallback(e,t){var r=getBindingCallback(e.callbackName,e.vmodels),n=e.parent;checkScan(n,function(){r&&r.call(n,t),("add"===t||"append"===t)&&scanNodes(n,[])})}function getLocatedNode(e,t,r){if(t.startRepeat){var n=t.startRepeat,a=t.endRepeat;r+=1;for(var o=0;r>o;o++)if(n=n.nextSibling,n==a)return a;return n}return e.childNodes[t.group*r]||null}function removeView(e,t,r){for(var n=t*(r||1),a=documentFragment.cloneNode(!1);--n>=0;){var o=e.nextSibling;if(a.appendChild(e),e=o,!e)break}return a}function createWithProxy(e,t,r){return modelFactory({$key:e,$outer:r,$val:t},0,{$val:1,$key:1})}function createEachProxy(e,t,r,n){var a=r.param||"el",o={$index:e,$itemName:a,$outer:r.$outer,$first:0===e,$last:e===n};o[a]=t,o.$remove=function(){return r.getter().removeAt(i.$index)};var i=modelFactory(o,0,watchEachOne);return i}function fireReady(){DOC.body&&(modules["ready!"].state=2,innerRequire.checkDeps(),fireReady=noop)}function doScrollCheck(){try{root.doScroll("left"),fireReady()}catch(e){setTimeout(doScrollCheck)}}var Registry={},expose=new Date-0,subscribers="$"+expose,window=this||(0,eval)("this"),otherRequire=window.require,otherDefine=window.define,stopRepeatAssign=!1,rword=/[^, ]+/g,class2type={},oproto=Object.prototype,ohasOwn=oproto.hasOwnProperty,prefix="ms-",W3C=window.dispatchEvent,root=DOC.documentElement,serialize=oproto.toString,ap=Array.prototype,aslice=ap.slice,head=DOC.head||DOC.getElementsByTagName("head")[0],documentFragment=DOC.createDocumentFragment(),DONT_ENUM="propertyIsEnumerable,isPrototypeOf,hasOwnProperty,toLocaleString,toString,valueOf,constructor".split(",");"Boolean Number String Function Array Date RegExp Object Error".replace(rword,function(e){class2type["[object "+e+"]"]=e.toLowerCase()});var rnative=/\[native code\]/,rchecktype=/^(?:object|array)$/,rwindow=/^\[object (Window|DOMWindow|global)\]$/;avalon=function(e){return new avalon.init(e)},avalon.init=function(e){this[0]=this.element=e},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=getType,avalon.isWindow=function(e){return e?e==e.document&&e.document!=e:!1},isWindow(window)&&(avalon.isWindow=isWindow),avalon.isPlainObject=function(e){if("object"!==getType(e)||e.nodeType||this.isWindow(e))return!1;try{if(e.constructor&&!ohasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},rnative.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(e){return e&&"object"==typeof e&&Object.getPrototypeOf(e)===oproto}),avalon.mix=avalon.fn.mix=function(){var e,t,r,n,a,o,i=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof i&&(c=i,i=arguments[1]||{},s++),"object"!=typeof i&&"function"!==getType(i)&&(i={}),s===l&&(i=this,s--);l>s;s++)if(null!=(e=arguments[s]))for(t in e)r=i[t],n=e[t],i!==n&&(c&&n&&(avalon.isPlainObject(n)||(a=Array.isArray(n)))?(a?(a=!1,o=r&&Array.isArray(r)?r:[]):o=r&&avalon.isPlainObject(r)?r:{},i[t]=avalon.mix(c,o,n)):void 0!==n&&(i[t]=n));return i};var eventMap=avalon.eventMap={};if(avalon.mix({rword:rword,subscribers:subscribers,ui:{},log:log,slice:W3C?function(e,t,r){return aslice.call(e,t,r)}:function(e,t,r){var n=[],a=e.length;t=resetNumber(t,a),r=resetNumber(r,a,1);for(var o=t;r>o;++o)n[o-t]=e[o];return n},noop:noop,error:function(e,t){throw new(t||Error)(e)},oneObject:oneObject,range:function(e,t,r){r||(r=1),null==t&&(t=e||0,e=0);for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r)),o=Array(a);++n<a;)o[n]=e,e+=r;return o},bind:function(e,t,r,n){var a=W3C?r:function(t){return r.call(e,fixEvent(t))};return W3C?e.addEventListener(eventMap[t]||t,a,!!n):e.attachEvent("on"+t,a),a},unbind:W3C?function(e,t,r,n){e.removeEventListener(eventMap[t]||t,r||noop,!!n)}:function(e,t,r){e.detachEvent("on"+t,r||noop)},css:function(e,t,r){e instanceof avalon&&(e=e[0]);var n=/[_-]/.test(t)?camelize(t):t;if(t=avalon.cssName(n)||n,void 0===r||"boolean"==typeof r){var a=cssHooks[n+":get"]||cssHooks["@:get"],o=a(e,t);return r===!0?parseFloat(o)||0:o}if(""===r)e.style[t]="";else{if(null==r||r!==r)return;isFinite(r)&&!avalon.cssNumber[n]&&(r+="px"),a=cssHooks[n+":set"]||cssHooks["@:set"],a(e,t,r)}},Array:{ensure:function(e,t){return-1===e.indexOf(t)&&e.push(t),e},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var r=e.indexOf(t);return~r?avalon.Array.removeAt(e,r):!1}}}),window.setImmediate)avalon.nextTick=setImmediate.bind(window);else if(window.VBArray){var handlerQueue=[];avalon.nextTick=function(e){"function"==typeof e&&handlerQueue.push(e);var t=DOC.createElement("script");t.onreadystatechange=function(){drainQueue(),t.onreadystatechange=null,root.removeChild(t),t=null},root.appendChild(t)}}else avalon.nextTick=function(e){setTimeout(e,0)};var VMODELS=avalon.vmodels={};avalon.each=function(e,t){if(e){var r=0;if(isArrayLike(e))for(var n=e.length;n>r;r++)t(r,e[r]);else for(r in e)e.hasOwnProperty(r)&&t(r,e[r])}},"司徒正美".trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")});for(var i in{toString:1})DONT_ENUM=!1;Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);if(DONT_ENUM&&e)for(var n=0;r=DONT_ENUM[n++];)e.hasOwnProperty(r)&&t.push(r);return t}),Array.isArray||(Array.isArray=function(e){return e&&"array"===getType(e)}),noop.bind||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,r=arguments;return function(){var n,a=[];for(n=1;n<r.length;n++)a.push(r[n]);for(n=0;n<arguments.length;n++)a.push(arguments[n]);return t.apply(e,a)}}),rnative.test([].map)||avalon.mix(ap,{indexOf:function(e,t){var r=this.length,n=~~t;for(0>n&&(n+=r);r>n;n++)if(this[n]===e)return n;return-1},lastIndexOf:function(e,t){var r=this.length,n=null==t?r-1:t;for(0>n&&(n=Math.max(0,r+n));n>=0;n--)if(this[n]===e)return n;return-1},forEach:iterator("","_",""),filter:iterator("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:iterator("r=[],","r[i]=_","return r"),some:iterator("","if(_)return true","return false"),every:iterator("","if(!_)return false","return true")}),root.contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),DOC.contains||(DOC.contains=function(e){return fixContains(this,e)});var openTag,closeTag,rexpr,rexprg,rbind,rregexp=/[-.*+?^${}()|[\]\/\\]/g,plugins={alias:function(e){log("alias已经被废弃，请使用paths, shim配置项");for(var t in e)if(ohasOwn.call(e,t)){var r=e[t];switch(getType(r)){case"string":kernel.paths[t]=r;break;case"object":r.src&&(kernel.paths[t]=r.src,delete r.src),kernel.shim[t]=r}}},loader:function(e){e?(window.define=innerRequire.define,window.require=innerRequire):(window.define=otherDefine,window.require=otherRequire)},interpolate:function(e){if(Array.isArray(e)&&e[0]&&e[1]&&e[0]!==e[1]){openTag=e[0],closeTag=e[1];var t=escapeRegExp(openTag),r=escapeRegExp(closeTag);rexpr=new RegExp(t+"(.*?)"+r),rexprg=new RegExp(t+"(.*?)"+r,"g"),rbind=new RegExp(t+".*?"+r+"|\\sms-")}}};kernel.plugins=plugins,kernel.plugins.interpolate(["{{","}}"]),kernel.paths={},kernel.shim={},avalon.config=kernel;var rparse=/^(?:null|false|true|NaN|\{.*\}|\[.*\])$/,rnospaces=/\S+/g;avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType?!!t.className&&(" "+t.className+" ").indexOf(" "+e+" ")>-1:void 0},addClass:function(e){var t=this[0];if(e&&"string"==typeof e&&t&&1===t.nodeType)if(t.className){var r=(t.className+" "+e).match(rnospaces);r.sort();for(var n=r.length-1;n>0;--n)r[n]===r[n-1]&&r.splice(n,1);t.className=r.join(" ")}else t.className=e;return this},removeClass:function(e){var t=this[0];if(e&&typeof e>"o"&&t&&1===t.nodeType&&t.className){for(var r=(e||"").match(rnospaces)||[],n=r.length,a=" "+t.className.match(rnospaces).join(" ")+" ",o=0;n>o;o++)a=a.replace(" "+r[o]+" "," ");t.className=a.slice(1,a.length-1)}return this},toggleClass:function(e,t){for(var r,n=t,a=0,o=e.match(rnospaces)||[],i="boolean"==typeof t;r=o[a++];)n=i?n:!this.hasClass(r),this[n?"addClass":"removeClass"](r);return this},attr:function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},data:function(e,t){switch(e="data-"+hyphen(e||""),arguments.length){case 2:return this.attr(e,t),this;case 1:var r=this.attr(e);return parseData(r);case 0:for(var n,a=this[0].attributes,o={},i=0;n=a[i++];)e=n.name,e.indexOf("data-")||(e=camelize(e.slice(5)),o[e]=parseData(n.value));return o}},removeData:function(e){return e="data-"+hyphen(e),this[0].removeAttribute(e),this},css:function(e,t){if(avalon.isPlainObject(e))for(var r in e)avalon.css(this,r,e[r]);else var n=avalon.css(this,e,t);return void 0!==n?n:this},position:function(){var e,t,r=this[0],n={top:0,left:0};if(r)return"fixed"===this.css("position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(n=e.offset()),n.top+=avalon.css(e[0],"borderTopWidth",!0),n.left+=avalon.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-avalon.css(r,"marginTop",!0),left:t.left-n.left-avalon.css(r,"marginLeft",!0)}},offsetParent:function(){for(var e=this[0].offsetParent||root;e&&"HTML"!==e.tagName&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||root)},bind:function(e,t,r){return this[0]?avalon.bind(this[0],e,t,r):void 0},unbind:function(e,t,r){return this[0]&&avalon.unbind(this[0],e,t,r),this},val:function(e){var t=this[0];if(t&&1===t.nodeType){var r=0===arguments.length,n=r?":get":":set",a=valHooks[getValType(t)+n];if(a)var o=a(t,e);else{if(r)return(t.value||"").replace(/\r/g,"");t.value=e}}return r?o:this}}),avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(r){var n=this[0]||{},a=getWindow(n),o="scrollTop"===e;return arguments.length?void(a?a.scrollTo(o?avalon(a).scrollLeft():r,o?r:avalon(a).scrollTop()):n[e]=r):a?t in a?a[t]:root[e]:n[e]}});var cssHooks=avalon.cssHooks={},prefixes=["","-webkit-","-o-","-moz-","-ms-"],cssMap={"float":"cssFloat",background:"backgroundColor"};if(avalon.cssNumber=oneObject("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,r){if(cssMap[e])return cssMap[e];t=t||root.style;for(var n=0,a=prefixes.length;a>n;n++)if(r=camelize(prefixes[n]+e),r in t)return cssMap[e]=r;return null},cssHooks["@:set"]=function(e,t,r){try{e.style[t]=r}catch(n){}},window.getComputedStyle)cssHooks["@:get"]=function(e,t){var r,n=window.getComputedStyle(e,null);return n&&(r="filter"===t?n.getPropertyValue(t):n[t],""===r&&(r=e.style[t])),r},cssHooks["opacity:get"]=function(e){var t=cssHooks["@:get"](e,"opacity");return""===t?"1":t};else{var rnumnonpx=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,rposition=/^(top|right|bottom|left)$/,ie8=!!window.XDomainRequest,salpha="DXImageTransform.Microsoft.Alpha",border={thin:ie8?"1px":"2px",medium:ie8?"3px":"4px",thick:ie8?"5px":"6px"};cssHooks["@:get"]=function(e,t){var r=e.currentStyle,n=r[t];if(rnumnonpx.test(n)&&!rposition.test(n)){var a=e.style,o=a.left,i=e.runtimeStyle.left;e.runtimeStyle.left=r.left,a.left="fontSize"===t?"1em":n||0,n=a.pixelLeft+"px",a.left=o,e.runtimeStyle.left=i}return"medium"===n&&(t=t.replace("Width","Style"),"none"===r[t]&&(n="0px")),""===n?"auto":border[n]||n},cssHooks["opacity:set"]=function(e,t,r){e.style.filter="alpha(opacity="+100*r+")",e.style.zoom=1},cssHooks["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[salpha],r=t?t.opacity:100;return r/100+""},"width,height".replace(rword,function(e){cssHooks[e+":get"]=function(t){return"width"===e?t.clientWidth-avalon.css(t,"paddingLeft",!0)-avalon.css(t,"paddingRight",!0):t.clientHeight-avalon.css(t,"paddingTop",!0)-avalon.css(t,"paddingBottom",!0)}})}"top,left".replace(rword,function(e){cssHooks[e+":get"]=function(t){var r=cssHooks["@:get"](t,e);return/px$/.test(r)?r:avalon(t).position()[e]+"px"}});var cssShow={position:"absolute",visibility:"hidden",display:"block"},rdisplayswap=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(rword,function(e){var t=e.toLowerCase(),r="client"+e,n="scroll"+e,a="offset"+e;cssHooks[t+"::get"]=function(e){var r=[];showHidden(e,r);for(var n,a=avalon.css(e,t,!0),o=0;n=r[o++];){e=n.node;for(var i in n)"string"==typeof n[i]&&(e.style[i]=n[i])}return a},avalon.fn[t]=function(o){var i=this[0];if(0===arguments.length){if(i.setTimeout)return i["inner"+e]||i.document.documentElement[r];if(9===i.nodeType){var s=i.documentElement;return Math.max(i.body[n],s[n],i.body[a],s[a],s[r])}return parseFloat(this.css(t))||0}return arguments.length?this.css(t,o):cssHooks[t+"::get"](i)}}),avalon.fn.offset=function(){var e=this[0],t=e&&e.ownerDocument,r={left:0,top:0};if(!t)return r;var n=e.getBoundingClientRect(),a=t.defaultView||t.parentWindow,o=navigator.vendor||"BackCompat"===t.compatMode?t.body:t.documentElement,i=o.clientTop>>0,s=o.clientLeft>>0,l=a.pageYOffset||o.scrollTop,c=a.pageXOffset||o.scrollLeft;return r.top=n.top+l-i,r.left=n.left+c-s,r};var valHooks={"option:get":function(e){if(e.hasAttribute)return e.hasAttribute("value")?e.value:e.text;var t=e.attributes.value;return void 0===t?e.text:t.specified?e.value:e.text},"select:get":function(e,t){for(var r,n=e.options,a=e.selectedIndex,o=valHooks["option:get"],i="select-one"===e.type||0>a,s=i?null:[],l=i?a+1:n.length,c=0>a?l:i?a:0;l>c;c++)if(r=n[c],(r.selected||c===a)&&!r.disabled){if(t=o(r),i)return t;s.push(t)}return s},"select:set":function(e,t){t=[].concat(t);for(var r,n=valHooks["option:get"],a=0;r=e.options[a++];)r.selected=!!~t.indexOf(n(r));t.length||(e.selectedIndex=-1)}},rtagName=/<([\w:]+)/,rxhtml=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rcreate=W3C?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,scriptTypes=oneObject("text/javascript","text/ecmascript","application/ecmascript","application/javascript","text/vbscript"),rnest=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,tagHooks={area:[1,"<map>"],param:[1,"<object>"],col:[2,"<table><tbody></tbody><colgroup>","</table>"],legend:[1,"<fieldset>"],option:[1,"<select multiple='multiple'>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>"],td:[3,"<table><tbody><tr>"],_default:W3C?[0,""]:[1,"X<div>"]};tagHooks.optgroup=tagHooks.option,tagHooks.tbody=tagHooks.tfoot=tagHooks.colgroup=tagHooks.caption=tagHooks.thead,tagHooks.th=tagHooks.td;var script=DOC.createElement("script");avalon.parseHTML=function(e){"string"!=typeof e&&(e+=""),e=e.replace(rxhtml,"<$1></$2>").trim();var t,r,n=(rtagName.exec(e)||["",""])[1].toLowerCase(),a=tagHooks[n]||tagHooks._default,o=documentFragment.cloneNode(!1),i=domParser;W3C||(e=e.replace(rcreate,"<br class=fixNoscope>$1")),i.innerHTML=a[1]+e+(a[2]||"");var s=i.getElementsByTagName("script");if(s.length)for(var l,c=0;l=s[c++];)if(!l.type||scriptTypes[l.type]){r=script.cloneNode(!1);for(var u,d=0;u=l.attributes[d++];)u.specified&&(r[u.name]=u.value);r.text=l.text,l.parentNode.replaceChild(r,l)}for(c=a[0];c--;i=i.lastChild);if(!W3C)for(s=i.getElementsByTagName("br"),c=0;l=s[c++];)l.className&&"fixNoscope"===l.className&&l.parentNode.removeChild(l);for(;t=i.firstChild;)o.appendChild(t);return o},avalon.innerHTML=function(e,t){if(!W3C&&!rcreate.test(t)&&!rnest.test(t))try{return void(e.innerHTML=t)}catch(r){}var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},avalon.clearHTML=function(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e};var Observable={$watch:function(e,t){if("function"==typeof t){var r=this.$events[e];r?r.push(t):this.$events[e]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(e,t){var r=arguments.length;if(0===r)this.$watch.backup=this.$events,this.$events={};else if(1===r)this.$events[e]=[];else for(var n=this.$events[e]||[],a=n.length;~--a<0;)if(n[a]===t)return n.splice(a,1);return this},$fire:function(e){for(var t,r=this.$events[e]||[],n=this.$events.$all||[],a=aslice.call(arguments,1),o=0;t=r[o++];)t.apply(this,a);for(var t,o=0;t=n[o++];)t.apply(this,arguments)}};avalon.define=function(e,t){var r=aslice.call(arguments);"string"!=typeof e&&(e=generateID(),r.unshift(e)),"function"!=typeof r[1]&&avalon.error("factory必须是函数"),t=r[1];var n={$watch:noop};t(n);var a=modelFactory(n);return stopRepeatAssign=!0,t(a),stopRepeatAssign=!1,a.$id=e,VMODELS[e]=a};var withProxyPool={},withProxyCount=0,rebindings={},isEqual=function(e,t){return e===t?e instanceof Date?e-0===t-0:!0:e!==e&&t!==t},safeFire=function(e,t,r,n){e.$events&&Observable.$fire.call(e,t,r,n)},skipProperties=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$accessors,"+subscribers).match(rword),descriptorFactory=W3C?function(e){var t={};for(var r in e)t[r]={get:e[r],set:e[r],enumerable:!0,configurable:!0};return t}:function(e){return e},defineProperty=Object.defineProperty;try{defineProperty({},"_",{value:"x"});var defineProperties=Object.defineProperties}catch(e){"__defineGetter__"in avalon&&(defineProperty=function(e,t,r){return"value"in r&&(e[t]=r.value),"get"in r&&e.__defineGetter__(t,r.get),"set"in r&&e.__defineSetter__(t,r.set),e},defineProperties=function(e,t){for(var r in t)t.hasOwnProperty(r)&&defineProperty(e,r,t[r]);return e})}!defineProperties&&window.VBArray&&(window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),defineProperties=function(e,t,r){var n="VBClass"+setTimeout("1"),a=[];a.push("Class "+n,"	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function");for(e in r)a.push("	Public ["+e+"]");a.push("	Public [hasOwnProperty]");for(e in t)e in r||a.push("	Public Property Let ["+e+"](val"+expose+")",'		Call [__proxy__]([__data__], "'+e+'", val'+expose+")","	End Property","	Public Property Set ["+e+"](val"+expose+")",'		Call [__proxy__]([__data__], "'+e+'", val'+expose+")","	End Property","	Public Property Get ["+e+"]","	On Error Resume Next","		Set["+e+'] = [__proxy__]([__data__],"'+e+'")',"	If Err.Number <> 0 Then","		["+e+'] = [__proxy__]([__data__],"'+e+'")',"	End If","	On Error Goto 0","	End Property");return a.push("End Class"),a.push("Function "+n+"Factory(a, b)","	Dim o","	Set o = (New "+n+")(a, b)","	Set "+n+"Factory = o","End Function"),window.parseVB(a.join("\r\n")),window[n+"Factory"](t,VBMediator)}),avalon.scan=function(e,t,r){e=e||root;var n=t?[].concat(t):[];scanTag(e,n,r)};var stopScan=oneObject("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),interval=W3C?15:50,rmsAttr=/ms-(\w+)-?(.*)/,priorityMap={"if":100,each:120,repeat:120,"with":120,duplex:2e4};if(!"1"[0])var cacheAttr=createCache(512),rattrs=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,rquote=/^['"]/,rtag=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,getAttributes=function(e){var t,r,n,a=e.outerHTML.match(rtag)[0],o=[];if(cacheAttr[a])return cacheAttr[a];for(;r=rattrs.exec(a);){n=r[2];var i=r[1].toLowerCase();t=i.match(rmsAttr);var s={name:i,specified:!0,nodeValue:n?rquote.test(n)?n.slice(1,-1):n:""};o.push(s)}return cacheAttr(a,o)};var rfilters=/\|\s*(\w+)\s*(\([^)]*\))?/g,r11a=/\|\|/g,r11b=/U2hvcnRDaXJjdWl0/g,keywords="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",rrexpstr=/\/\*(?:.|\n)*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|'[^']*'|"[^"]*"|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,rsplit=/[^\w$]+/g,rkeywords=new RegExp(["\\b"+keywords.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),rnumber=/\b\d[^,]*/g,rcomma=/^,+|,+$/g,getVariables=function(e){return e=e.replace(rrexpstr,"").replace(rsplit,",").replace(rkeywords,"").replace(rnumber,"").replace(rcomma,""),e?e.split(/,+/):[]},cacheExpr=createCache(256);avalon.parseExprProxy=parseExprProxy;var cacheDisplay=oneObject("a,abbr,b,span,strong,em,font,i,kbd","inline");avalon.mix(cacheDisplay,oneObject("div,h1,h2,h3,h4,h5,h6,section,p","block")),avalon.parseDisplay=parseDisplay;
var supportDisplay=function(e){return window.getComputedStyle?"table-cell"===window.getComputedStyle(e,null).display:!0}(DOC.createElement("td")),domParser=DOC.createElement("div");domParser.setAttribute("className","t");var fuckIEAttr="t"===domParser.className,propMap={"class":"className","for":"htmlFor"},rdash=/\(([^)]*)\)/,styleEl='<style id="avalonStyle">.fixMsIfFlicker{ display: none!important }</style>';styleEl=avalon.parseHTML(styleEl).firstChild,head.insertBefore(styleEl,null);var rnoscripts=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,rnoscriptText=/<noscript.*?>([\s\S]+?)<\/noscript>/im,getXHR=function(){return new(window.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},getBindingCallback=function(e,t){if(e)for(var r,n=0;r=t[n++];)if(r.hasOwnProperty(e)&&"function"==typeof r[e])return r[e]},includeContents={},ifSanctuary=DOC.createElement("div");ifSanctuary.innerHTML="a";try{ifSanctuary.contains(ifSanctuary.firstChild),avalon.contains=function(e,t){return e.contains(t)}}catch(e){avalon.contains=fixContains}var bindingExecutors=avalon.bindingExecutors={attr:function(e,t,r){function n(e){c&&(e=c.apply(t,[e].concat(s))),avalon.innerHTML(t,e),scanNodes(t,s),l&&checkScan(t,function(){l.call(t)})}var a=r.type,o=r.param;if("css"===a)avalon(t).css(o,e);else if("attr"===a){var i=e===!1||null===e||void 0===e;i&&t.removeAttribute(o),fuckIEAttr&&o in propMap?(o=propMap[o],i?t.removeAttribute(o):t[o]=e):i||t.setAttribute(o,e)}else if("include"===a&&e){var s=r.vmodels,l=getBindingCallback(t.getAttribute("data-include-rendered"),s),c=getBindingCallback(t.getAttribute("data-include-loaded"),s);if("src"===r.param)if(includeContents[e])n(includeContents[e]);else{var u=getXHR();u.onreadystatechange=function(){if(4===u.readyState){var t=u.status;(t>=200&&300>t||304===t||1223===t)&&n(includeContents[e]=u.responseText)}},u.open("GET",e,!0),"withCredentials"in u&&(u.withCredentials=!0),u.setRequestHeader("X-Requested-With","XMLHttpRequest"),u.send(null)}else{var d=e&&1==e.nodeType?e:DOC.getElementById(e);if(d){if("NOSCRIPT"===d.tagName&&!d.innerHTML&&!d.fixIE78){var u=getXHR();u.open("GET",location,!1),u.send(null);for(var p=DOC.getElementsByTagName("noscript"),f=(u.responseText||"").match(rnoscripts)||[],v=f.length,h=0;v>h;h++){var m=p[h];m&&(m.style.display="none",m.fixIE78=(f[h].match(rnoscriptText)||["","&nbsp;"])[1])}}avalon.nextTick(function(){n(d.fixIE78||d.innerText||d.innerHTML)})}}}else t[a]=e},"class":function(e,t,r){var n=avalon(t),a=r.type;if("class"===a&&r.param)n.toggleClass(r.param,!!e);else{var o=r._evaluator?!!r._evaluator.apply(t,r._args):!0,i=r._class||e;switch(a){case"class":o&&r.oldClass&&n.removeClass(r.oldClass),n.toggleClass(i,o),r.oldClass=i;break;case"hover":case"active":if(!r.init){if("hover"===a)var s="mouseenter",l="mouseleave";else t.tabIndex=t.tabIndex||-1,s="mousedown",l="mouseup",n.bind("mouseleave",function(){o&&n.removeClass(i)});n.bind(s,function(){o&&n.addClass(i)}),n.bind(l,function(){o&&n.removeClass(i)}),r.init=1}}}},data:function(e,t,r){var n="data-"+r.param;e&&"object"==typeof e?t[n]=e:t.setAttribute(n,String(e))},checked:function(e,t,r){var n=r.type;if("enabled"===n)t.disabled=!e;else{var a="readonly"===n?"readOnly":n;t[a]=!!e}},each:function(e,t,r){var n=this,a=n.group,o=n.parent,i=n.proxies;if("del"==e||"move"==e)var s=getLocatedNode(o,n,t);switch(e){case"add":var l=r,c=n.getter().length-1;w=documentFragment.cloneNode(!1);for(var u=0,d=l.length;d>u;u++){var p=u+t,f=createEachProxy(p,l[u],n,c),v=n.template.cloneNode(!0);i.splice(p,0,f),avalon.vmodels["proxy"+p]=f,scanNodes(v,[f].concat(n.vmodels)),"number"!=typeof a&&(n.group=v.childNodes.length),w.appendChild(v)}s=getLocatedNode(o,n,t),0===t&&avalon(o).addClass("fixMsIfFlicker"),o.insertBefore(w,s),0===t&&avalon(o).removeClass("fixMsIfFlicker");break;case"del":i.splice(t,r),removeFromSanctuary(removeView(s,a,r));break;case"index":for(var c=i.length-1;r=i[t];t++)r.$index=t,r.$first=0===t,r.$last=t===c;break;case"clear":var h=documentFragment.cloneNode(!1);if(n.startRepeat)for(;;){var m=n.startRepeat.nextSibling;if(!m||m===n.endRepeat)break;h.appendChild(m)}else for(;o.firstChild;)h.appendChild(o.firstChild);removeFromSanctuary(h),i.length=0;break;case"move":var g=i.splice(t,1)[0];if(g){i.splice(r,0,g);var y=removeView(s,a);s=getLocatedNode(o,n,r),o.insertBefore(y,s)}break;case"set":var f=i[t];f&&(f[f.$itemName]=r);break;case"append":var b=t,x=r,w=documentFragment.cloneNode(!1);for(var C in b)if(b.hasOwnProperty(C)&&"hasOwnProperty"!==C){var v=n.template.cloneNode(!0),f=x[C],k="object"==typeof b[C]?[f,f.$val]:[f];scanNodes(v,k.concat(n.vmodels)),w.appendChild(v)}o.appendChild(w)}iteratorCallback(n,e)},html:function(e,t,r){if(e=null==e?"":e,t||(t=r.element=r.node.parentNode),r.replaceNodes){var n,a;if(11===e.nodeType)n=e;else if(1===e.nodeType||e.item)for(a=1===e.nodeType?e.childNodes:e.item?e:[],n=documentFragment.cloneNode(!0);a[0];)n.appendChild(a[0]);else n=avalon.parseHTML(e);var o=avalon.slice(n.childNodes);t.insertBefore(n,r.replaceNodes[0]||null);for(var i,s=0;i=r.replaceNodes[s++];)t.removeChild(i);r.replaceNodes=o}else avalon.innerHTML(t,e);avalon.nextTick(function(){scanNodes(t,r.vmodels)})},"if":function(e,t,r){var n=r.placehoder;if(e){if(!r.msInDocument){r.msInDocument=!0;try{n.parentNode.replaceChild(t,n)}catch(a){avalon.log("ms-if errer"+a.message)}}}else r.msInDocument&&(r.msInDocument=!1,t.parentNode.replaceChild(n,t),n.elem=t,ifSanctuary.appendChild(t))},on:function(e,t,r){var n=r.evaluator,a=r.args,o=r.vmodels;if(callback=r.hasArgs?function(e){return n.apply(this,a.concat(e))}:function(e){return n.apply(0,a).call(this,e)},t.$vmodel=o[0],t.$vmodels=o,"function"==typeof r.specialBind)r.specialBind(t,callback);else var i=avalon.bind(t,r.param,callback);r.rollback=function(){"function"==typeof r.specialUnbind?r.specialUnbind():avalon.unbind(t,r.param,i)},r.evaluator=r.handler=noop},text:function(e,t,r){e=null==e?"":e,3===r.nodeType?r.node.nodeValue=e:(t||(t=r.element=r.node.parentNode),"textContent"in t?t.textContent=e:t.innerText=e)},visible:function(e,t,r){t.style.display=e?r.display:"none"}},bindingHandlers=avalon.bindingHandlers={attr:function(e,t){var r=e.value.trim(),n=!0;r.indexOf(openTag)>-1&&r.indexOf(closeTag)>2&&(n=!1,rexpr.test(r)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(n=!0,r=RegExp.$1)),e.handlerName="attr",parseExprProxy(r,t,e,n?null:scanExpr(e.value))},bind:function(){log("请改用$watch与ms-attr-id实现,详看https://github.com/RubyLouvre/avalon/issues/196")},checked:function(e,t){e.handlerName="checked",parseExprProxy(e.value,t,e)},"class":function(e,t){var r,n=e.param,a=e.value;if(e.handlerName="class",!n||isFinite(n)){e.param="";var o=a.replace(rexprg,function(e){return Math.pow(10,e.length-1)}),i=o.indexOf(":");if(-1===i)var s=a;else{if(s=a.slice(0,i),r=a.slice(i+1),parseExpr(r,t,e),!e.evaluator)return log("'"+(r||"").trim()+"' 不存在于VM中"),!1;e._evaluator=e.evaluator,e._args=e.args}var l=rexpr.test(s);l||(e._class=s),parseExprProxy("",t,e,l?scanExpr(s):null)}else"class"===e.type&&parseExprProxy(a,t,e)},duplex:function(e,t){var r=e.element,n=r.tagName;if("function"==typeof modelBinding[n]&&t&&t.length){for(var a,o=e.value.split("."),i=o[0],s=o[1],l=0;a=t[l++];)if(a.hasOwnProperty(i)){if(!s||!a[i])break;if(a[i].hasOwnProperty(s))break}r.name||(r.name=generateID()),/radio|checkbox|select/.test(r.type)?log("data-duplex-changed回调只能应用于非radio,checkbox,select等控件中"):e.changed=getBindingCallback(r.getAttribute("data-duplex-changed"),t),parseExpr(e.value,t,e,"duplex");var c=r.form;c&&c.msValidate&&c.msValidate(r),modelBinding[r.tagName](r,e.evaluator,a,e)}},each:function(e,t){var r,n=e.type,a=e.element;parseExpr(e.value,t,e),e.getter=function(){return this.evaluator.apply(0,this.args||[])},e.parent=a,e.handler=bindingExecutors.each,e.callbackName=a.getAttribute("data-"+(n||"each")+"-rendered");var o="$first",i="$last";"with"==n&&(o="$key",i="$val");for(var s,l=0;s=t[l++];)if(s.hasOwnProperty(o)&&s.hasOwnProperty(i)){e.$outer=s;break}e.$outer=e.$outer||{};var c=documentFragment.cloneNode(!1);if("repeat"===n){var u=DOC.createComment("ms-repeat-start"),d=DOC.createComment("ms-repeat-end");e.element=e.parent=a.parentNode,e.startRepeat=u,e.endRepeat=d,a.removeAttribute(e.name),e.parent.replaceChild(d,a),e.parent.insertBefore(u,d),c.appendChild(a)}else for(;a.firstChild;)c.appendChild(a.firstChild);e.template=c;try{if(r=e.getter(),!rchecktype.test(getType(r)))return}catch(p){return}if(r[subscribers]&&r[subscribers].push(e),"with"===n){var f=withProxyPool[r.$id];if(!f){withProxyCount++,f=withProxyPool[r.$id]={};for(var v in r)r.hasOwnProperty(v)&&"hasOwnPropery"!==v&&(f[v]=createWithProxy(v,r[v],e.$outer))}e.rollback=function(){for(var e=this.parent,t=documentFragment.cloneNode(!1);e.firstChild;)t.appendChild(e.firstChild);removeFromSanctuary(t),e.appendChild(this.template)},e.handler("append",r,f)}else e.proxies=[],e.handler("add",0,r)},html:function(e,t){parseExprProxy(e.value,t,e)},"if":function(e,t){var r=e.element;avalon(r).addClass("fixMsIfFlicker");var n=r["data-if-vmodels"]||[];return t=n.length<t.length?t:n,root.contains(r)?void(t.length&&(r["data-if-vmodels"]=void 0,r.removeAttribute(e.name),avalon(r).removeClass("fixMsIfFlicker"),e.placehoder=DOC.createComment("ms-if"),e.msInDocument=e.vmodels=t,scanAttr(r,t),parseExprProxy(e.value,t,e))):void(r["data-if-vmodels"]=t)},on:function(e,t){var r=e.value,n="$event";if(r.indexOf("(")>0&&r.indexOf(")")>-1){var a=(r.match(rdash)||["",""])[1].trim();(""===a||"$event"===a)&&(n=void 0,r=r.replace(rdash,""))}else n=void 0;e.type="on",e.hasArgs=n,e.handlerName="on",parseExprProxy(r,t,e,n)},ui:function(){log("ms-ui已废弃，请使用更方便的ms-widget")},visible:function(e,t){var r=e.element;if(!supportDisplay&&!root.contains(r))var n=parseDisplay(r.tagName);n=n||avalon(r).css("display"),e.display="none"===n?parseDisplay(r.tagName):n,parseExprProxy(e.value,t,e)},widget:function(e,t){var r=e.value.match(rword),n=e.element,a=r[0],o={};"$"===r[1]&&(r[1]=void 0),r[1]||(r[1]=a+setTimeout("1")),e.value=r.join(",");var i=avalon.ui[a];if("function"==typeof i){for(var s,l=0;s=t[l++];)if(VMODELS[s.$id]){var c=s;break}var u=r[2]||a;if(c&&"object"==typeof c[u]){o=c[u],o=o.$model||o;var d=o[a+"Id"];"string"==typeof d&&(r[1]=d)}var p=filterData(avalon(n).data(),r[0]);e[a+"Id"]=r[1],e[a+"Options"]=avalon.mix({},i.defaults,o,p),n.removeAttribute("ms-widget"),i(n,e,t),e.evaluator=noop}return!0}};"hover,active".replace(rword,function(e){bindingHandlers[e]=bindingHandlers["class"]}),"with,repeat".replace(rword,function(e){bindingHandlers[e]=bindingHandlers.each}),"disabled,enabled,readonly,selected".replace(rword,function(e){bindingHandlers[e]=bindingHandlers.checked}),bindingHandlers.data=bindingHandlers.text=bindingHandlers.html,"title,alt,src,value,css,include,href".replace(rword,function(e){bindingHandlers[e]=bindingHandlers.attr});var modelBinding=bindingHandlers.duplex;modelBinding.INPUT=function(e,t,r,n){var a,o=n.param,i=e.type,s=avalon(e);"checkbox"===i&&"radio"===o&&(i="radio");var l=n.changed?function(){return n.changed.call(e,e.value)}:function(){return e.value},c=function(){s.data("duplex-observe")!==!1&&t(r,l())};if(n.handler=function(){var n=t(r);n!==e.value&&(e.value=n+"")},"radio"===i)n.handler=function(){e.defaultChecked=e.checked="text"===o?t(r)===e.value:!!t(r)},c=function(){if(s.data("duplex-observe")!==!1)if("text"===o)t(r,e.value);else{var n=!e.defaultChecked;t(r,n),e.checked=n}},a=s.bind("click",c),n.rollback=function(){s.unbind("click",a)};else if("checkbox"===i)c=function(){if(s.data("duplex-observe")!==!1){var n=e.checked?"ensure":"remove";avalon.Array[n](t(r),e.value)}},n.handler=function(){var n=[].concat(t(r));e.checked=n.indexOf(e.value)>=0},a=s.bind("click",c),n.rollback=function(){s.unbind("click",a)};else{var u=e.attributes["data-duplex-event"]||e.attributes["data-event"]||{};if(u=u.value,"change"===u)avalon.bind(e,u,c);else if(W3C?(e.addEventListener("input",c),n.rollback=function(){e.removeEventListener("input",c)}):(a=function(e){"value"===e.propertyName&&c()},e.attachEvent("onpropertychange",a),n.rollback=function(){e.detachEvent("onpropertychange",a)}),9===DOC.documentMode){var d=function(e){"focus"===e.type?DOC.addEventListener("selectionchange",c):DOC.removeEventListener("selectionchange",c)};e.addEventListener("focus",d),e.addEventListener("blur",d);var p=n.rollback;n.rollback=function(){p(),e.removeEventListener("focus",d),e.removeEventListener("blur",d)}}}registerSubscriber(n)},modelBinding.SELECT=function(e,t,r,n,a){function o(){if(i.data("duplex-observe")!==!1){var e=i.val();e+""!==a&&(t(r,e),a=e+"")}}var i=avalon(e);n.handler=function(){var e=t(r);e=e&&e.$model||e,e=Array.isArray(e)?e.map(String):e+"",e+""!==a&&(i.val(e),a=e+"")};var s=i.bind("change",o);n.rollback=function(){i.unbind("change",s)};var l=0/0,c=setInterval(function(){var t=e.innerHTML;t===l?(clearInterval(c),registerSubscriber(n)):l=t},20)},modelBinding.TEXTAREA=modelBinding.INPUT;var eventName={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};for(var name in eventName)if(/object|function/.test(typeof window[name])){eventMap.animationend=eventName[name];break}if("dblclick,mouseout,click,mouseover,mouseenter,mouseleave,mousemove,mousedown,mouseup,keypress,keydown,keyup,blur,focus,change,animationend".replace(rword,function(e){bindingHandlers[e]=function(t){t.param=e,bindingHandlers.on.apply(0,arguments)}}),!("onmouseenter"in root)){var oldBind=avalon.bind,events={mouseenter:"mouseover",mouseleave:"mouseout"};avalon.bind=function(e,t,r){return events[t]?oldBind(e,events[t],function(n){var a=n.relatedTarget;return a&&(a===e||16&e.compareDocumentPosition(a))?void 0:(delete n.type,n.type=t,r.call(e,n))}):oldBind(e,t,r)}}var _splice=ap.splice,CollectionPrototype={_splice:_splice,_add:function(e,t){var r=this.length;t="number"==typeof t?t:r;for(var n=[],a=0,o=e.length;o>a;a++)n[a]=convert(e[a]);return _splice.apply(this,[t,0].concat(n)),notifySubscribers(this,"add",t,n),this._stopFireLength?void 0:this._.length=this.length},_del:function(e,t){var r=this._splice(e,t);return r.length&&(notifySubscribers(this,"del",e,t),this._stopFireLength||(this._.length=this.length)),r},push:function(){return ap.push.apply(this.$model,arguments),this._add(arguments)},unshift:function(){ap.unshift.apply(this.$model,arguments);var e=this._add(arguments,0);return notifySubscribers(this,"index",arguments.length),e},shift:function(){var e=this.$model.shift();return this._del(0,1),notifySubscribers(this,"index",0),e},pop:function(){var e=this.$model.pop();return this._del(this.length-1,1),e},splice:function(e){e=resetNumber(e,this.length);var t=_splice.apply(this.$model,arguments),r=[];return this._stopFireLength=!0,t.length&&(r=this._del(e,t.length),arguments.length<=2&&notifySubscribers(this,"index",e)),arguments.length>2&&this._add(aslice.call(arguments,2),e),this._stopFireLength=!1,this._.length=this.length,r},contains:function(e){return-1!==this.indexOf(e)},size:function(){return this._.length},remove:function(e){var t=this.indexOf(e);return t>=0?this.removeAt(t):void 0},removeAt:function(e){this.splice(e,1)},clear:function(){return this.$model.length=this.length=this._.length=0,notifySubscribers(this,"clear",0),this},removeAll:function(e){if(Array.isArray(e))e.forEach(function(e){this.remove(e)},this);else if("function"==typeof e)for(var t=this.length-1;t>=0;t--){var r=this[t];e(r,t)&&this.splice(t,1)}else this.clear()},ensure:function(e){return this.contains(e)||this.push(e),this},set:function(e,t){if(e>=0&&e<this.length){var r=getType(t);t&&t.$model&&(t=t.$model);var n=this[e];if("object"===r)for(var a in t)n.hasOwnProperty(a)&&(n[a]=t[a]);else"array"===r?n.clear().push.apply(n,t):n!==t&&(this[e]=t,notifySubscribers(this,"set",e,t))}return this}};"sort,reverse".replace(rword,function(e){CollectionPrototype[e]=function(){var t=this.$model,r=t.slice(0),n=!1;ap[e].apply(t,arguments);for(var a=0,o=r.length;o>a;a++){var i=t[a],s=r[a];if(!isEqual(i,s)){n=!0;var l=getIndex(i,r,a),c=this._splice(l,1)[0],u=r.splice(l,1)[0];this._splice(a,0,c),r.splice(a,0,u),notifySubscribers(this,"move",l,a)}}return r=void 0,n&&notifySubscribers(this,"index",0),this}});var queryComments=DOC.createTreeWalker?function(e){for(var t,r=DOC.createTreeWalker(e,NodeFilter.SHOW_COMMENT,null,null),n=[];t=r.nextNode();)n.push(t);return n}:function(e){return e.getElementsByTagName("!")},watchEachOne=oneObject("$index,$first,$last"),filters=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,r){return t=t||30,r=void 0===r?"...":r,e.length>t?e.slice(0,t-r.length)+r:String(e)},camelize:camelize,escape:function(e){return String(e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},currency:function(e,t){return t=t||"￥",t+avalon.filters.number(e)},number:function(e,t,r,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,i=n||",",s=r||".",l="",c=function(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r};return l=(o?c(a,o):""+Math.round(a)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(l[1]||"").length<o&&(l[1]=l[1]||"",l[1]+=new Array(o-l[1].length+1).join("0")),l.join(s)}};!new function(){function e(e){return parseInt(e,10)}function t(e,t,r){var n="";for(0>e&&(n="-",e=-e),e=""+e;e.length<t;)e="0"+e;return r&&(e=e.substr(e.length-t)),n+e}function r(e,r,n,a){return function(o){var i=o["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&-12===n&&(i=12),t(i,r,a)}}function n(e,t){return function(r,n){var a=r["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return n[o][a]}}function a(e){var r=-1*e.getTimezoneOffset(),n=r>=0?"+":"";return n+=t(Math[r>0?"floor":"ceil"](r/60),2)+t(Math.abs(r%60),2)}function o(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function i(t){var r;if(r=t.match(u)){var n=new Date(0),a=0,o=0,i=r[8]?n.setUTCFullYear:n.setFullYear,s=r[8]?n.setUTCHours:n.setHours;r[9]&&(a=e(r[9]+r[10]),o=e(r[9]+r[11])),i.call(n,e(r[1]),e(r[2])-1,e(r[3]));var l=e(r[4]||0)-a,c=e(r[5]||0)-o,d=e(r[6]||0),p=Math.round(1e3*parseFloat("0."+(r[7]||0)));return s.call(n,l,c,d,p),n}return t}var s={yyyy:r("FullYear",4),yy:r("FullYear",2,0,!0),y:r("FullYear",1),MMMM:n("Month"),MMM:n("Month",!0),MM:r("Month",2,1),M:r("Month",1,1),dd:r("Date",2),d:r("Date",1),HH:r("Hours",2),H:r("Hours",1),hh:r("Hours",2,-12),h:r("Hours",1,-12),mm:r("Minutes",2),m:r("Minutes",1),ss:r("Seconds",2),s:r("Seconds",1),sss:r("Milliseconds",3),EEEE:n("Day"),EEE:n("Day",!0),a:o,Z:a},l=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,c=/^\d+$/,u=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;filters.date=function(t,r){var n,a,o=filters.date.locate,u="",d=[];if(r=r||"mediumDate",r=o[r]||r,"string"==typeof t&&(t=c.test(t)?e(t):i(t),t=new Date(t)),"number"==typeof t&&(t=new Date(t)),"date"===getType(t)){for(;r;)a=l.exec(r),a?(d=d.concat(a.slice(1)),r=d.pop()):(d.push(r),r=null);return d.forEach(function(e){n=s[e],u+=n?n(t,o):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}};var d={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};d.SHORTMONTH=d.MONTH,filters.date.locate=d};var innerRequire,modules=avalon.modules={"ready!":{exports:avalon},avalon:{exports:avalon,state:2}};!new function(){function e(e){return(e||"").replace(/[?#].*/,"")}function t(e){var t;try{a.b.c()}catch(r){t=r.stack,!t&&window.opera&&(t=(String(r).match(/of linked script \S+/g)||[]).join(" "))}if(t)return t=t.split(/[@ ]/g).pop(),t="("===t[0]?t.slice(1,-1):t.replace(/\s/,""),t.replace(/(:\d+)?:\d+$/i,"");for(var n,o=(e?DOC:head).getElementsByTagName("script"),i=o.length;n=o[--i];)if((e||n.className===subscribers)&&"interactive"===n.readyState)return n.className=n.src}function r(e,t){for(var n in e)if("司徒正美"===e[n]&&2!==modules[n].state&&(n===t||r(modules[n].deps,t)))return!0}function n(){e:for(var e,t=u.length;e=u[--t];){var r=modules[e],a=r.deps;for(var o in a)if(ohasOwn.call(a,o)&&2!==modules[o].state)continue e;2!==r.state&&(u.splice(t,1),l(r.id,r.args,r.factory),n())}}function o(t,r,n){var a=e(t.src);return t.onload=t.onreadystatechange=t.onerror=null,r||n&&!modules[a].state?(setTimeout(function(){head.removeChild(t),t=null}),void log("加载 "+a+" 失败"+r+" "+!modules[a].state)):!0}function i(t,r,n,a){if("ready!"===t||modules[t]&&2===modules[t].state)return t;"object"==typeof kernel.shim[t]&&(a=kernel.shim[t]),kernel.paths[t]&&(t=kernel.paths[t]);var o;if(t=t.replace(/^\w+!/,function(e){return o=e.slice(0,-1),""}),o=o||"js",o=plugins[o]||noop,/^(\w+)(\d)?:.*/.test(t))n=t;else{r=r.substr(0,r.lastIndexOf("/"));var i=t.charAt(0);if("."!==i&&"/"!==i)n=c+t;else if("./"===t.slice(0,2))n=r+t.slice(1);else if(".."===t.slice(0,2)){var s=r.replace(/\/$/,"").split("/");i=t.replace(/\.\.\//g,function(){return s.pop(),""}),n=s.join("/")+"/"+i}else"/"===i?n=r+t:avalon.error("不符合模块标识规则: "+t)}t=e(n);var l=o.ext;return l&&t.slice(0-l.length)!==l&&(n+=l),kernel.nocache&&(n+=(-1===n.indexOf("?")?"?":"&")+(new Date-0)),o(n,a)}function s(e,t,r){var n=DOC.createElement("script");n.className=subscribers,n[W3C?"onload":"onreadystatechange"]=function(){if(W3C||/loaded|complete/i.test(n.readyState)){var a=d.pop();a&&a.delay(t),r&&r(),o(n,!1,!W3C)&&log("已成功加载 "+e)}},n.onerror=function(){o(n,!0)},n.src=e,head.insertBefore(n,head.firstChild),log("正准备加载 "+e)}function l(e,t,r){for(var n,a=0,o=[];n=t[a++];)o.push(modules[n].exports);var i=Object(modules[e]),s=r.apply(window,o);return i.state=2,void 0!==s&&(modules[e].exports=s),s}var c,u=[],d=[];plugins.js=function(t,r){var n=e(t);return modules[n]||(modules[n]={id:n,parent:parent,exports:{}},r?innerRequire(r.deps||"",function(){s(t,n,function(){modules[n].state=2,r.exports&&(modules[n].exports="function"==typeof r.exports?r.exports():window[r.exports]),innerRequire.checkDeps()})}):s(t,n)),n},plugins.css=function(e){var t=e.replace(/(#.+|\W)/g,"");if(!DOC.getElementById(t)){var r=DOC.createElement("link");r.rel="stylesheet",r.href=e,r.id=t,head.insertBefore(r,head.firstChild)}},plugins.css.ext=".css",plugins.js.ext=".js";var p=t(!0);p||(p=avalon.slice(DOC.scripts).pop().src);var f=e(p);c=kernel.base=f.slice(0,f.lastIndexOf("/")+1),innerRequire=avalon.require=function(e,t,r){var a={},o=[],s=0,d=0,p=r||"callback"+setTimeout("1");r=r||c,String(e).replace(rword,function(e){var t=i(e,r);t&&(s++,modules[t]&&2===modules[t].state&&d++,a[t]||(o.push(t),a[t]="司徒正美"))}),modules[p]={id:p,factory:t,deps:a,args:o,state:1},s===d?l(p,o,t):u.unshift(p),n()},innerRequire.define=function(n,a,o){var i=aslice.call(arguments);if("string"==typeof n)var s=i.shift();if("boolean"==typeof i[0]){if(i[0])return;i.shift()}"function"==typeof i[0]&&i.unshift([]);var l=modules[s]&&modules[s].state>=1?s:e(t());!modules[l]&&s&&(modules[l]={id:l,factory:o,state:1}),o=i[1],o.id=s,o.delay=function(e){i.push(e);var t=!0;try{t=r(modules[e].deps,e)}catch(n){}t&&avalon.error(e+"模块与之前的某些模块存在循环依赖"),delete o.delay,innerRequire.apply(null,i)},l?o.delay(l,i):d.push(o)},innerRequire.define.amd=modules,innerRequire.config=kernel,innerRequire.checkDeps=n};var ready=W3C?"DOMContentLoaded":"readystatechange";"complete"===DOC.readyState?fireReady():W3C?DOC.addEventListener(ready,function(){fireReady()}):(DOC.attachEvent("onreadystatechange",function(){"complete"===DOC.readyState&&fireReady()}),root.doScroll&&doScrollCheck()),avalon.ready=function(e){innerRequire("ready!",e)},avalon.config({loader:!0});var msSelector="[ms-controller],[ms-important],[ms-widget]";avalon.ready(function(){if(W3C&&DOC.querySelectorAll){for(var e,t=DOC.querySelectorAll(msSelector),r=[],n=0;e=t[n++];)if(!e.__root__){for(var a,o=e.querySelectorAll(msSelector),i=0;a=o[i++];)a.__root__=!0;r.push(e)}for(var e,n=0;e=r[n++];)avalon.scan(e)}else avalon.scan(DOC.body)})}(document),avalon.config({loader:!1}),avalon.filters.richText=function(e){return e.replace(/\r?\n/gi,"<br/>")},avalon.filters.md2html=function(e){return Converter.makeHtml(e)},avalon.filters.addSyntexType=function(e){var t=e.split("<pre><code>$"),r=t.length;if(r>1)for(var n=0;r>n+1;n++){var a=t[n+1].indexOf("$"),o=t[n+1].substr(0,a);t[n]+='<pre><code class="language-'+o+'">',t[n+1]=t[n+1].substr(a+1,t[n+1].length),t[n+1]=t[n+1].replace(/\n/,"")}return t.join("")};