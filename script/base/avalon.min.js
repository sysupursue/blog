!function(DOC){function noop(){}function log(e){window.console&&console.log(W3C?e:e+"")}function getType(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?class2type[serialize.call(e)]||"object":typeof e}function isWindow(e){return rwindow.test(serialize.call(e))}function resetNumber(e,t,n){return e=e!==+e||e%1?n?t:0:0>e?-1*e>=t?0:e+t:e>t?t:e}function oneObject(e,t){"string"==typeof e&&(e=e.match(rword)||[]);for(var n={},r=void 0!==t?t:1,a=0,o=e.length;o>a;a++)n[e[a]]=r;return n}function isArrayLike(e){if(e&&"object"==typeof e){var t=e.length;if(+t===t&&!(t%1)&&t>=0)try{return{}.propertyIsEnumerable.call(e,"length")===!1?Array.isArray(e)||/^\s?function/.test(e.item||e.callee):!0}catch(n){return!0}}return!1}function generateID(){return"avalon"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function iterator(e,t,n){var r="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",r)}function kernel(e){for(var t in e)if(ohasOwn.call(e,t)){var n=e[t];"function"==typeof kernel.plugins[t]?kernel.plugins[t](n):kernel[t]=n}return this}function escapeRegExp(e){return(e+"").replace(rregexp,"\\$&")}function hyphen(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function camelize(e){return e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function parseData(val){var _eval=!1;(rparse.test(val)||+val+""===val)&&(_eval=!0);try{return _eval?eval("0,"+val):val}catch(e){return val}}function getWindow(e){return e.window&&e.document?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}function getValType(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}function updateViewModel(e,t,n){if("array"===n){var r=t.concat();return e.clear(),e.push.apply(e,r),e}var a=[],o=[],i=[],s=[],l=[],c=e[subscribers],u=e.$model;for(var p in u)t&&t.hasOwnProperty(p)||(o.push(p),delete u[p]);for(var p in t)t.hasOwnProperty(p)&&"hasOwnProperty"!==p&&(e.hasOwnProperty(p)||a.push(p),l.push(p));for(var p in u)u.hasOwnProperty(p)&&(s.push(p),u[p]!==t[p]&&i.push(p));c.forEach(function(e){e("remove",o)}),c.forEach(function(e){e("add",t)}),i.length&&i.forEach(function(n){var r=getType(t[n]);rchecktype.test(r)?updateViewModel(e[n],t[n],r):e[n]=t[n]}),s.join(";")!==l.join(";")&&c.forEach(function(e){e("sort",l,s)});var f=e.$events;if(a.length||o.length){for(var d,g=e.$model,p=0;d=o[p++];)delete g[d],delete f[d],delete e.$accessor[d];for(p=0,d;d=a[p++];)g[d]=t[d];e=modelFactory(g,g,{},e.$accessor)}return e[subscribers]=c,c.forEach(function(t){t.host=e}),e.$events=f,e}function modelFactory(e,t,n,r){function a(e,r){unwatchOne[e]||(t[e]=r);var a=getType(r);if("function"===a)p.push(e);else{if(-1!==i.indexOf(e)||"$"===e.charAt(0)&&!n[e])return p.push(e);var o,f;if("object"===a&&"function"==typeof r.get&&Object.keys(r).length<=2){var d=r.set,g=r.get;o=function(n){var r=o.value,a=r;if(!arguments.length)return openComputedCollect&&collectSubscribers(o),n=o.value=t[e]=g.call(s),isEqual(r,n)||(f=void 0,s.$fire&&s.$fire(e,n,r)),n;if(!stopRepeatAssign){if("function"==typeof d){var i=s.$events[e];s.$events[e]=[],d.call(s,n),s.$events[e]=i}isEqual(f,n)||(f=n,r=o.value=t[e]=g.call(s),notifySubscribers(o),s.$fire&&s.$fire(e,r,a))}},u.push(o)}else o=function(n){var r,i=o.value,l=i;return arguments.length?(stopRepeatAssign||isEqual(i,n)||(rchecktype.test(a)?("value"in o?(i=updateViewModel(i,n,a),s.$fire&&s.$fire(e,i,l)):i=n.$model?n:modelFactory(n,n),o[subscribers]=i[subscribers],r=i.$model):i=n,o.value=i,t[e]=r?r:i,notifySubscribers(o),r||s.$fire&&s.$fire(e,i,l)),void 0):(collectSubscribers(o),i)},c.push(e);o[subscribers]=[],l[e]={set:o,get:o,enumerable:!0}}}if(Array.isArray(e)){var o=Collection(e);return o._add(e),o}var i=e.$skipArray,s={},l={},c=[],u=[],p=Object.keys(unwatchOne);t=t||{},n=n||{},i=Array.isArray(i)?i.concat(p):p;for(var f in e)a(f,e[f]);if(r)for(var f in r)l[f]=r[f];s=defineProperties(s,l,p),p.forEach(function(t){unwatchOne[t]||(s[t]=e[t])}),c.forEach(function(t){s[t]=e[t]}),u.forEach(function(e){Registry[expose]=e,e(),collectSubscribers(e),delete Registry[expose]}),s.$model=t,s.$events={},s.$id=generateID(),s.$accessor=l,s[subscribers]=[];for(var f in Observable){var d=Observable[f];W3C||(d=d.bind(s)),s[f]=d}return s.hasOwnProperty=function(e){return e in s.$model},s}function VBMediator(e,t,n){var r=e[t]&&e[t].set;return 3!==arguments.length?r():(r(n),void 0)}function registerSubscriber(e,t){e.element=t.element,e.state=t.state,Registry[expose]=e,openComputedCollect=!0,e(),openComputedCollect=!1,delete Registry[expose]}function collectSubscribers(e){if(Registry[expose]){var t=e[subscribers];t&&avalon.Array.ensure(t,Registry[expose])}}function notifySubscribers(e){var t=e[subscribers];if(t&&t.length)for(var n,r=aslice.call(arguments,1),a=t.concat(),o=0;n=a[o++];){var i,s=n.element,l=n.state;if(s&&(!l||0!==l.sourceIndex))if("number"==typeof s.sourceIndex)i=0===s.sourceIndex;else try{i=!root.contains(s)}catch(c){for(i=!0;s==s.parentNode;)if(s===root){i=!1;break}}i?avalon.Array.remove(t,n):n.apply(0,r)}}function scanNodes(e,t,n){for(var r,a=[],o=0;r=e.childNodes[o++];)a.push(r);for(var o=0;r=a[o++];)1===r.nodeType?scanTag(r,t,n):3===r.nodeType&&scanText(r,t,n)}function scanTag(e,t,n,r){t=t||[];var a=e.getAttribute(prefix+"skip"),o=e.getAttributeNode(prefix+"important"),i=e.getAttributeNode(prefix+"controller");if("string"!=typeof a){if(r=o||i){var s=VMODELS[r.value];if(!s)return;t=r===o?[s]:[s].concat(t),e.removeAttribute(r.name)}scanAttr(e,t,function(n){!stopScan[e.tagName.toLowerCase()]&&rbind.test(e.innerHTML)&&scanNodes(e,t,n)},n)}}function scanText(e,t,n){var r=extractTextBindings(e);r.length&&executeBindings(r,t,n)}function scanExpr(e){var t,n,r=[],a=0;if(rexpr.test(e)){for(;;){if(n=e.indexOf(openTag,a),-1===n)break;if(t=e.slice(a,n),t&&r.push({value:t,expr:!1}),a=n+openTag.length,n=e.indexOf(closeTag,a),-1===n)break;if(t=e.slice(a,n)){var o=[];t.indexOf("|")>0&&(t=t.replace(rfilters,function(e,t,n){return o.push(t+(n||"")),""})),r.push({value:t,expr:!0,filters:o.length?o:void 0})}a=n+closeTag.length}t=e.slice(a),t&&r.push({value:t,expr:!1})}return r}function scanAttr(e,t,n,r,a){for(var o,i=[],s=0;o=e.attributes[s++];)if(o.specified&&-1!==o.name.indexOf(prefix)){var l=o.name.split("-"),c=l[1];"function"==typeof bindingHandlers[c]&&function(t){var n={type:c,param:l.slice(2).join("-"),element:e,remove:!0,node:t,value:t.nodeValue};"ms-if"===t.name?a=n:i.push(n)}(o)}i.sort(function(e,t){return e.node.name>t.node.name}),a?(a.state={},bindingHandlers["if"](a,t,function(){executeBindings(i,t,a.state),n(a.state)})):(executeBindings(i,t,r),n(r))}function executeBindings(e,t,n){e.forEach(function(e){e.state=n,bindingHandlers[e.type](e,t),e.remove&&e.element.removeAttribute(e.node.name),e.remove=!0}),e.length=0}function extractTextBindings(e){var t=[],n=scanExpr(e.nodeValue);if(n.length){for(;n.length;){var r=n.shift(),a=DOC.createTextNode(r.value);if(r.expr){var o=r.filters,i={type:"text",node:a,param:"",element:e.parentNode,value:r.value,filters:o};o&&-1!==o.indexOf("html")&&(avalon.Array.remove(o,"html"),i.type="html",i.replaceNodes=[a]),t.push(i)}documentFragment.appendChild(a)}e.parentNode.replaceChild(documentFragment,e)}return t}function addAssign(e,t,n){for(var r=[],a=" = "+n+".",o=e.length;n=e[--o];)n=e[o],t.hasOwnProperty(n)&&(r.push(n+a+n),e.splice(o,1));return r}function uniqArray(e,t){var n=e.length;if(1>=n)return e;if(2===n)return e[0]!==e[1]?e:[e[0]];var r={};return e.filter(function(e){var n=t?e&&e.$id:e;return r[n]?!1:(r[n]=1,!0)})}function parseExpr(e,t,n,r){if("setget"===r){var a=Function("a","b","if(arguments.length === 2){\n	a."+e+" = b;\n }else{\n	return a."+e+";\n}");l=t}else{var o=getVariables(e),i=[],s=[],l=[],c="";o=uniqArray(o),t=uniqArray(t,1);for(var u=0,p=t.length;p>u;u++)if(o.length){var f="vm"+expose+"_"+u;s.push(f),l.push(t[u]),i.push.apply(i,addAssign(o,t[u],f))}var c=i.join(", ");if(c&&(c="var "+c),"on"===n.type&&(e=e.replace("(",".call(this,"),"$event"===r&&s.push(r)),n.filters){e="\nvar ret"+expose+" = "+e;var d,g=[];g.push(e,"\r\n");for(var h,u=0;h=n.filters[u++];){var v=h.indexOf("(");-1!==v?(d=h.slice(v+1,h.lastIndexOf(")")).trim(),d=","+d,h=h.slice(0,v).trim()):d="",g.push(" if(filters",expose,".",h,"){\n	try{\nret",expose," = filters",expose,".",h,"(ret",expose,d,")\n	}catch(e){} \n}\n")}e=g.join(""),e+="\nreturn ret"+expose,s.push("filters"+expose),l.push(avalon.filters),delete n.filters}else e="\nreturn "+e+";";try{a=Function.apply(Function,s.concat("'use strict';\n"+c+e))}catch(m){}}try{return"on"!==n.type&&"setget"!==r&&a.apply(a,l),[a,l]}catch(m){delete n.remove}finally{g=s=null}}function updateViewFactory(e,t,n,r,a){var o,i;if(a)o=a.map(function(e){return e.expr?parseExpr(e.value,t,n)||"":e.value}),i=function(e,t){return function(){for(var r,a,o="",i=0;a=e[i++];)"string"==typeof a?o+=a:(r=a[0],o+=r.apply(r,a[1]));return t(o,n.element)}}(o,r);else if(o=parseExpr(e,t,n)){var s=o[0],l=o[1];i=function(){r(s.apply(s,l),n.element)}}i&&(i.toString=function(){return n.type+" binding to eval("+e+")"},registerSubscriber(i,n))}function parseDisplay(e,t){if(e=e.toLowerCase(),!cacheDisplay[e]){var n=DOC.createElement(e);root.appendChild(n),t=window.getComputedStyle?window.getComputedStyle(n,null).display:n.currentStyle.display,root.removeChild(n),cacheDisplay[e]=t}return cacheDisplay[e]}function fixEvent(e){var t=e.target=e.srcElement;if(e.which=null!=e.charCode?e.charCode:e.keyCode,/mouse|click/.test(e.type)){var n=t.ownerDocument||DOC,r="BackCompat"===n.compatMode?n.body:n.documentElement;e.pageX=e.clientX+(r.scrollLeft>>0)-(r.clientLeft>>0),e.pageY=e.clientY+(r.scrollTop>>0)-(r.clientTop>>0)}return e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e}function convert(e){var t=getType(e);return rchecktype.test(t)&&(e=e.$id?e:modelFactory(e,e,t)),e}function getVMIndex(e,t,n){for(var r=n,a=t.length;a>r;r++){var o=t[r],i=o&&o.$model?o.$model:o;if(isEqual(e,i))return r}return-1}function Collection(e){var t=[];t.$id=generateID(),t[subscribers]=[],t.$model=e.concat(),t.$events={},t._=modelFactory({length:e.length}),t._.$watch("length",function(e,n){t.$fire("length",e,n)});for(var n in Observable)t[n]=Observable[n];return avalon.mix(t,CollectionPrototype),t}function eachIterator(e,t,n,r,a){var o=r.group,i=r.element,s=r.mapper;if("del"==e||"move"==e)var l=getLocatedNode(i,o,t);switch(e){case"add":for(var c=t,t=n,u=documentFragment.cloneNode(!1),p=0,f=c.length;f>p;p++){var d=p+t,g=createEachProxy(d,c[p],a,r.param),h=r.template.cloneNode(!0);s.splice(d,0,g);var v="object"==typeof c[p]?[g,c[p]]:[g];scanNodes(h,v.concat(r.vmodels),r.state),g.$accessor.$last.get.element=h.firstChild,"number"!=typeof o&&(r.group=h.childNodes.length),u.appendChild(h)}l=getLocatedNode(i,o,t),i.insertBefore(u,l);break;case"del":s.splice(t,n),removeView(l,o,n);break;case"index":for(;n=s[t];t++)n.$index=t;break;case"clear":s.length=0,avalon.clearChild(i);break;case"move":var m=s.splice(t,1)[0];if(m){s.splice(n,0,m);var y=removeView(l,o);l=getLocatedNode(i,o,n),i.insertBefore(y,l)}break;case"set":var b=s[t];if(b){var f=b.$itemName;b[f]=n}}}function withIterator(e,t,n,r,a,o){var i=r.group,s=r.element,l=r.markstone,c=[];switch(o=o||documentFragment.cloneNode(!1),e){case"append":var u=t,p=withMapper[a.$id]||(withMapper[a.$id]={});if(!p[u]){var f=createWithProxy(u,n);p[u]=f,n&&n.$model&&(f.$events=a.$events,f[subscribers]=a[subscribers]),a.$watch(u,function(e){f.$val=e})}var d=r.template.cloneNode(!0);scanNodes(d,[p[u],n].concat(r.vmodels),r.state),"number"!=typeof i&&(r.group=d.childNodes.length),l[u]=d.firstChild,o.appendChild(d);break;case"sort":for(var g,h=0;g=t[h++];){var v=l[g],m=removeView(v,i);o.appendChild(m)}s.appendChild(o);break;case"add":for(var h in t)t.hasOwnProperty(h)&&"hasOwnProperty"!==h&&(l.hasOwnProperty(h)||(withIterator("append",h,t[h],r,a,o),c.push(h)));return s.appendChild(o),c;case"remove":for(var g,y=[],h=0;g=t[h++];){var v=l[g];v&&(l[g]=withMapper[a.$id][g]=0,y.push(v),gatherRemovedNodes(y,v,i))}for(h=0;v=y[h++];)s.removeChild(v);return c}}function gatherRemovedNodes(e,t,n){for(var r=1;n>r;r++)t=t.nextSibling,e.push(t);return e}function getLocatedNode(e,t,n){return e.childNodes[t*n]||null}function removeView(e,t,n){n=n||1;for(var e,r=gatherRemovedNodes([e],e,t*n),a=documentFragment.cloneNode(!1),o=0;e=r[o++];)a.appendChild(e);return a}function createWithProxy(e,t){return modelFactory({$key:e,$val:t},0,{$val:1})}function createEachProxy(e,t,n,r){r=r||"el";var a={};a.$index=e,a.$itemName=r,a[r]={get:function(){return t},set:function(e){t=e}},a.$first={get:function(){return 0===this.$index}},a.$last={get:function(){var e="function"==typeof n.size?n.size():n.length;return this.$index===e-1}},a.$remove=function(){return n.removeAt(o.$index)};var o=modelFactory(a,0,watchEachOne);return o}function fireReady(){document.body&&(modules["ready!"].state=2,innerRequire.checkDeps(),fireReady=noop)}function doScrollCheck(){try{root.doScroll("left"),fireReady()}catch(e){setTimeout(doScrollCheck)}}var Registry={},expose=new Date-0,subscribers="$"+expose,otherRequire=window.require,otherDefine=window.define,stopRepeatAssign=!1,openComputedCollect=!1,rword=/[^, ]+/g,class2type={},oproto=Object.prototype,ohasOwn=oproto.hasOwnProperty,prefix="ms-",W3C=window.dispatchEvent,root=DOC.documentElement,serialize=oproto.toString,aslice=[].slice,head=DOC.head||DOC.getElementsByTagName("head")[0],documentFragment=DOC.createDocumentFragment(),DONT_ENUM="propertyIsEnumerable,isPrototypeOf,hasOwnProperty,toLocaleString,toString,valueOf,constructor".split(",");"Boolean Number String Function Array Date RegExp Object Error".replace(rword,function(e){class2type["[object "+e+"]"]=e.toLowerCase()});var rnative=/\[native code\]/,rchecktype=/^(?:object|array)$/,rwindow=/^[object (Window|DOMWindow|global)]$/;avalon=function(e){return new avalon.init(e)},avalon.init=function(e){this[0]=this.element=e},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=getType,avalon.isWindow=function(e){return e?e==e.document&&e.document!=e:!1},isWindow(window)&&(avalon.isWindow=isWindow),avalon.isPlainObject=function(e){if("object"!==getType(e)||e.nodeType||this.isWindow(e))return!1;try{if(e.constructor&&!ohasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},rnative.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(e){return e&&"object"==typeof e&&Object.getPrototypeOf(e)===oproto}),avalon.mix=avalon.fn.mix=function(){var e,t,n,r,a,o,i=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof i&&(c=i,i=arguments[1]||{},s++),"object"!=typeof i&&"function"!==getType(i)&&(i={}),s===l&&(i=this,s--);l>s;s++)if(null!=(e=arguments[s]))for(t in e)n=i[t],r=e[t],i!==r&&(c&&r&&(avalon.isPlainObject(r)||(a=Array.isArray(r)))?(a?(a=!1,o=n&&Array.isArray(n)?n:[]):o=n&&avalon.isPlainObject(n)?n:{},i[t]=avalon.mix(c,o,r)):void 0!==r&&(i[t]=r));return i};var eventMap=avalon.eventMap={};avalon.mix({rword:rword,subscribers:subscribers,ui:{},log:log,slice:W3C?function(e,t,n){return aslice.call(e,t,n)}:function(e,t,n){var r=[],a=e.length;t=resetNumber(t,a),n=resetNumber(n,a,1);for(var o=t;n>o;++o)r[o-t]=e[o];return r},noop:noop,error:function(e,t){throw new(t||Error)(e)},oneObject:oneObject,range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n)),o=Array(a);++r<a;)o[r]=e,e+=n;return o},bind:function(e,t,n,r){function a(t){var r=t.target?t:fixEvent(t||window.event),a=n.call(e,r);return a===!1&&(r.preventDefault(),r.stopPropagation()),a}if(W3C)e.addEventListener(eventMap[t]||t,a,!!r);else try{e.attachEvent("on"+t,a)}catch(o){}return a},unbind:W3C?function(e,t,n,r){e.removeEventListener(eventMap[t]||t,n||noop,!!r)}:function(e,t,n){e.detachEvent("on"+t,n||noop)},css:function(e,t,n){if(e instanceof avalon){var r=e;e=e[0]}var a=/[_-]/.test(t)?camelize(t):t;if(t=avalon.cssName(a)||a,void 0===n||"boolean"==typeof n){var o=cssHooks[a+":get"]||cssHooks["@:get"],i=o(e,t);return n===!0?parseFloat(i)||0:i}if(""===n)e.style[t]="";else{if(null==n||n!==n)return;isFinite(n)&&!avalon.cssNumber[a]&&(n+="px"),o=cssHooks[a+":set"]||cssHooks["@:set"],o(e,t,n)}return r}});var BrowserMutationObserver=window.MutationObserver||window.WebKitMutationObserver;avalon.nextTick=BrowserMutationObserver?function(e){var t=DOC.createElement("input"),n=new BrowserMutationObserver(function(t){t.forEach(function(){e()})});n.observe(t,{attributes:!0}),t.setAttribute("value",Math.random())}:window.VBArray?function(e){var t=DOC.createElement("script");t.onreadystatechange=function(){e(),t.onreadystatechange=null,root.removeChild(t),t=null},root.appendChild(t)}:function(e){setTimeout(e,0)};var VMODELS=avalon.vmodels={};avalon.each=function(e,t){if(e){var n=0;if(isArrayLike(e))for(var r=e.length;r>n;n++)t(n,e[n]);else for(n in e)e.hasOwnProperty(n)&&t(n,e[n])}},"司徒正美".trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")});for(var i in{toString:1})DONT_ENUM=!1;Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);if(DONT_ENUM&&e)for(var r=0;n=DONT_ENUM[r++];)e.hasOwnProperty(n)&&t.push(n);return t}),Array.isArray||(Array.isArray=function(e){return e&&"array"===getType(e)}),noop.bind||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,n=arguments;return function(){var r,a=[];for(r=1;r<n.length;r++)a.push(n[r]);for(r=0;r<arguments.length;r++)a.push(arguments[r]);return t.apply(e,a)}}),rnative.test([].map)||avalon.mix(Array.prototype,{indexOf:function(e,t){var n=this.length,r=~~t;for(0>r&&(r+=n);n>r;r++)if(this[r]===e)return r;return-1},lastIndexOf:function(e,t){var n=this.length,r=null==t?n-1:t;for(0>r&&(r=Math.max(0,n+r));r>=0;r--)if(this[r]===e)return r;return-1},forEach:iterator("","_",""),filter:iterator("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:iterator("r=[],","r[i]=_","return r"),some:iterator("","if(_)return true","return false"),every:iterator("","if(!_)return false","return true")}),root.contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))});var openTag,closeTag,rexpr,rexprg,rbind,rregexp=/[-.*+?^${}()|[\]\/\\]/g,plugins={alias:function(e){var t=kernel.alias;for(var n in e)if(ohasOwn.call(e,n)){var r=t[n],a=e[n];r&&avalon.error("注意 "+n+" 已经重写过"),t[n]=a}},loader:function(e){e?(window.define=innerRequire.define,window.require=innerRequire):(window.define=otherDefine,window.require=otherRequire)},interpolate:function(e){if(Array.isArray(e)&&e[0]&&e[1]&&e[0]!==e[1]){openTag=e[0],closeTag=e[1];var t=escapeRegExp(openTag),n=escapeRegExp(closeTag);rexpr=new RegExp(t+"(.*?)"+n),rexprg=new RegExp(t+"(.*?)"+n,"g"),rbind=new RegExp(t+".*?"+n+"|\\sms-")}}};kernel.plugins=plugins,kernel.plugins.interpolate(["{{","}}"]),kernel.alias={},avalon.config=kernel;var rparse=/^(?:null|false|true|NaN|\{.*\}|\[.*\])$/,rnospaces=/\S+/g;avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType?!!t.className&&(" "+t.className+" ").indexOf(" "+e+" ")>-1:void 0},addClass:function(e){var t=this[0];if(e&&"string"==typeof e&&t&&1===t.nodeType)if(t.className){var n=(t.className+" "+e).match(rnospaces);n.sort();for(var r=n.length-1;r>0;--r)n[r]===n[r-1]&&n.splice(r,1);t.className=n.join(" ")}else t.className=e;return this},removeClass:function(e){var t=this[0];if(e&&typeof e>"o"&&t&&1===t.nodeType&&t.className){for(var n=(e||"").match(rnospaces)||[],r=n.length,a=" "+t.className.match(rnospaces).join(" ")+" ",o=0;r>o;o++)a=a.replace(" "+n[o]+" "," ");t.className=a.slice(1,a.length-1)}return this},toggleClass:function(e,t){for(var n,r=t,a=0,o=e.match(rnospaces)||[],i="boolean"==typeof t;n=o[a++];)r=i?r:!this.hasClass(n),this[r?"addClass":"removeClass"](n);return this},attr:function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},data:function(e,t){switch(e="data-"+hyphen(e||""),arguments.length){case 2:return this.attr(e,t),this;case 1:var n=this.attr(e);return parseData(n);case 0:for(var r,a=this[0].attributes,o={},i=0;r=a[i++];)e=r.name,e.indexOf("data-")||(e=camelize(e.slice(5)),o[e]=parseData(r.value));return o}},removeData:function(e){return e="data-"+hyphen(e),this[0].removeAttribute(e),this},css:function(e,t){return avalon.css(this,e,t)},position:function(){var e,t,n=this[0],r={top:0,left:0};if(n)return"fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(r=e.offset()),r.top+=avalon.css(e[0],"borderTopWidth",!0),r.left+=avalon.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-avalon.css(n,"marginTop",!0),left:t.left-r.left-avalon.css(n,"marginLeft",!0)}},offsetParent:function(){for(var e=this[0].offsetParent||root;e&&"HTML"!==e.tagName&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||root)},bind:function(e,t,n){return this[0]?avalon.bind(this[0],e,t,n):void 0},unbind:function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},val:function(e){var t=this[0];if(t&&1===t.nodeType){var n=0===arguments.length,r=n?":get":":set",a=valHooks[getValType(t)+r];if(a)var o=a(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?o:this}}),avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var r=this[0]||{},a=getWindow(r),o="scrollTop"===e;return arguments.length?(a?a.scrollTo(o?avalon(a).scrollLeft():n,o?n:avalon(a).scrollTop()):r[e]=n,void 0):a?t in a?a[t]:root[e]:r[e]}});var cssHooks=avalon.cssHooks={},prefixes=["","-webkit-","-o-","-moz-","-ms-"],cssMap={"float":"cssFloat"in root.style?"cssFloat":"styleFloat",background:"backgroundColor"};if(avalon.cssNumber=oneObject("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(cssMap[e])return cssMap[e];t=t||root.style;for(var r=0,a=prefixes.length;a>r;r++)if(n=camelize(prefixes[r]+e),n in t)return cssMap[e]=n;return null},cssHooks["@:set"]=function(e,t,n){try{e.style[t]="",e.style[t]=n}catch(r){}},window.getComputedStyle)cssHooks["@:get"]=function(e,t){var n,r=window.getComputedStyle(e,null);return r&&(n="filter"===t?r.getPropertyValue(t):r[t],""===n&&(n=e.style[t])),n},cssHooks["opacity:get"]=function(e){var t=cssHooks["@:get"](e,"opacity");return""===t?"1":t};else{var rnumnonpx=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,rposition=/^(top|right|bottom|left)$/,ie8=!!window.XDomainRequest,salpha="DXImageTransform.Microsoft.Alpha",border={thin:ie8?"1px":"2px",medium:ie8?"3px":"4px",thick:ie8?"5px":"6px"};cssHooks["@:get"]=function(e,t){var n=e.currentStyle,r=n[t];if(rnumnonpx.test(r)&&!rposition.test(r)){var a=e.style,o=a.left,i=e.runtimeStyle.left;e.runtimeStyle.left=n.left,a.left="fontSize"===t?"1em":r||0,r=a.pixelLeft+"px",a.left=o,e.runtimeStyle.left=i}return"medium"===r&&(t=t.replace("Width","Style"),"none"===n[t]&&(r="0px")),""===r?"auto":border[r]||r},cssHooks["opacity:set"]=function(e,t,n){e.style.filter="alpha(opacity="+100*n+")",e.style.zoom=1},cssHooks["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[salpha],n=t?t.opacity:100;return n/100+""}}"top,left".replace(rword,function(e){cssHooks[e+":get"]=function(t){var n=cssHooks["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}}),"Width,Height".replace(rword,function(e){var t=e.toLowerCase(),n="client"+e,r="scroll"+e,a="offset"+e;avalon.fn[t]=function(o){var i=this[0];if(0===arguments.length){if(i.setTimeout)return i["inner"+e]||i.document.documentElement[n];if(9===i.nodeType){var s=i.documentElement;return Math.max(i.body[r],s[r],i.body[a],s[a],s[n])}return parseFloat(this.css(t))||0}return this.css(t,o)}}),avalon.fn.offset=function(){var e=this[0],t=e&&e.ownerDocument,n={left:0,top:0};if(!t)return n;var r=e.getBoundingClientRect(),a=t.defaultView||t.parentWindow,o=navigator.vendor||"BackCompat"===t.compatMode?t.body:t.documentElement,i=o.clientTop>>0,s=o.clientLeft>>0,l=a.pageYOffset||o.scrollTop,c=a.pageXOffset||o.scrollLeft;return n.top=r.top+l-i,n.left=r.left+c-s,n};var valHooks={"option:get":function(e){if(e.hasAttribute)return e.hasAttribute("value")?e.value:e.text;var t=e.attributes.value;return void 0===t?e.text:t.specified?e.value:e.text},"select:get":function(e,t){for(var n,r=e.options,a=e.selectedIndex,o=valHooks["option:get"],i="select-one"===e.type||0>a,s=i?null:[],l=i?a+1:r.length,c=0>a?l:i?a:0;l>c;c++)if(n=r[c],(n.selected||c===a)&&!n.disabled){if(t=o(n),i)return t;s.push(t)}return s},"select:set":function(e,t){t=[].concat(t);for(var n,r=valHooks["option:get"],a=0;n=e.options[a++];)n.selected=!!~t.indexOf(r(n));t.length||(e.selectedIndex=-1)}};avalon.Array={ensure:function(e){var t=aslice.call(arguments,1);return t.forEach(function(t){~e.indexOf(t)||e.push(t)}),e},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}};var rtagName=/<([\w:]+)/,rxhtml=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rcreate=W3C?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,scriptTypes=oneObject("text/javascript","text/ecmascript","application/ecmascript","application/javascript","text/vbscript"),rnest=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,tagHooks={area:[1,"<map>"],param:[1,"<object>"],col:[2,"<table><tbody></tbody><colgroup>","</table>"],legend:[1,"<fieldset>"],option:[1,"<select multiple='multiple'>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>"],td:[3,"<table><tbody><tr>"],_default:W3C?[0,""]:[1,"X<div>"]};tagHooks.optgroup=tagHooks.option,tagHooks.tbody=tagHooks.tfoot=tagHooks.colgroup=tagHooks.caption=tagHooks.thead,tagHooks.th=tagHooks.td,avalon.clearChild=function(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e},avalon.parseHTML=function(e){e=e.replace(rxhtml,"<$1></$2>").trim();var t,n=(rtagName.exec(e)||["",""])[1].toLowerCase(),r=tagHooks[n]||tagHooks._default,a=documentFragment.cloneNode(!1),o=domParser;W3C||(e=e.replace(rcreate,"<br class=fix_noscope>$1")),o.innerHTML=r[1]+e+(r[2]||"");var i=o.getElementsByTagName("script");if(i.length)for(var s,l,c=DOC.createElement("script"),u=0;l=i[u++];)if(!l.type||scriptTypes[l.type]){s=c.cloneNode(!1);for(var p,f=0;p=l.attributes[f++];)p.specified&&(s[p.name]=p.value);s.text=l.text,l.parentNode.replaceChild(s,l)}for(u=r[0];u--;o=o.lastChild);if(!W3C)for(i=o.getElementsByTagName("br"),u=0;l=i[u++];)l.className&&"fix_noscope"===l.className&&l.parentNode.removeChild(l);for(;t=o.firstChild;)a.appendChild(t);return a},avalon.innerHTML=function(e,t){if(!W3C&&!rcreate.test(t)&&!rnest.test(t))try{return e.innerHTML=t,void 0}catch(n){}var r=this.parseHTML(t);this.clearChild(e).appendChild(r)},avalon.define=function(e,t){var n=aslice.call(arguments);"string"!=typeof e&&(e=generateID(),n.unshift(e)),"function"!=typeof n[1]&&avalon.error("factory必须是函数"),t=n[1];var r={$watch:noop};t(r);var a=modelFactory(r);return stopRepeatAssign=!0,t(a),stopRepeatAssign=!1,a.$id=e,VMODELS[e]=a};var Observable={$watch:function(e,t){if("function"==typeof t){var n=this.$events[e];n?n.push(t):this.$events[e]=[t]}else this.$events=this.$watch.backup;return this},$unwatch:function(e,t){var n=arguments.length;if(0===n)this.$watch.backup=this.$events,this.$events={};else if(1===n)this.$events[e]=[];else for(var r=this.$events[e]||[],a=r.length;~--a<0;)if(r[a]===t)return r.splice(a,1);return this},$fire:function(e){for(var t,n=this.$events[e]||[],r=this.$events.$all||[],a=aslice.call(arguments,1),o=0;t=n[o++];)t.apply(this,a);for(var t,o=0;t=r[o++];)t.apply(this,a)}},isEqual=function(e,t){return e===t?e instanceof Date?e-0===t-0:!0:e!==e&&t!==t},unwatchOne=oneObject("$id,$skipArray,$watch,$unwatch,$fire,$events,$model,$accessor,"+subscribers),defineProperty=Object.defineProperty;try{defineProperty({},"_",{value:"x"});var defineProperties=Object.defineProperties}catch(e){"__defineGetter__"in avalon&&(defineProperty=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},defineProperties=function(e,t){for(var n in t)t.hasOwnProperty(n)&&defineProperty(e,n,t[n]);return e})}!defineProperties&&window.VBArray&&(window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),defineProperties=function(e,t,n){e=n.slice(0),e.push("hasOwnProperty");var r="VBClass"+setTimeout("1"),a={},o=[];o.push("Class "+r,"	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function"),e.forEach(function(e){a[e]!==!0&&(a[e]=!0,o.push("	Public ["+e+"]"))});for(var i in t)a[i]=!0,o.push("	Public Property Let ["+i+"](val"+expose+")",'		Call [__proxy__]([__data__], "'+i+'", val'+expose+")","	End Property","	Public Property Set ["+i+"](val"+expose+")",'		Call [__proxy__]([__data__], "'+i+'", val'+expose+")","	End Property","	Public Property Get ["+i+"]","	On Error Resume Next","		Set["+i+'] = [__proxy__]([__data__],"'+i+'")',"	If Err.Number <> 0 Then","		["+i+'] = [__proxy__]([__data__],"'+i+'")',"	End If","	On Error Goto 0","	End Property");return o.push("End Class"),o.push("Function "+r+"Factory(a, b)","	Dim o","	Set o = (New "+r+")(a, b)","	Set "+r+"Factory = o","End Function"),window.parseVB(o.join("\r\n")),window[r+"Factory"](t,VBMediator)}),avalon.scan=function(e,t,n){e=e||root;var r=t?[].concat(t):[];scanTag(e,r,n)};var stopScan=oneObject("area,base,basefont,br,col,hr,img,input,link,meta,param,embed,wbr,script,style,textarea"),rfilters=/\|\s*(\w+)\s*(\([^)]*\))?/g,keywords="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",rrexpstr=/\/\*(?:.|\n)*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|'[^']*'|"[^"]*"|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,rsplit=/[^\w$]+/g,rkeywords=new RegExp(["\\b"+keywords.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),rnumber=/\b\d[^,]*/g,rcomma=/^,+|,+$/g,getVariables=function(e){return e=e.replace(rrexpstr,"").replace(rsplit,",").replace(rkeywords,"").replace(rnumber,"").replace(rcomma,""),e?e.split(/,+/):[]};avalon.parseExpr=parseExpr,avalon.updateViewFactory=updateViewFactory;var cacheDisplay=oneObject("a,abbr,b,span,strong,em,font,i,kbd","inline");avalon.mix(cacheDisplay,oneObject("div,h1,h2,h3,h4,h5,h6,section,p","block")),avalon.parseDisplay=parseDisplay;var supportDisplay=function(e){return window.getComputedStyle?"table-cell"===window.getComputedStyle(e,null).display:!0}(DOC.createElement("td")),domParser=DOC.createElement("div");domParser.setAttribute("className","t");var fuckIEAttr="t"===domParser.className,propMap={"class":"className","for":"htmlFor"},rdash=/\(([^)]*)\)/,styleEl='<style id="avalonStyle">.fixMsIfFlicker{ display: none!important }</style>';if(styleEl=avalon.parseHTML(styleEl).firstChild,head.insertBefore(styleEl,null),DOC.implementation&&DOC.implementation.hasFeature("MutationEvents","2.0")){var ifCallbacks=[];root.addEventListener("DOMNodeInserted",function(e){for(var t,n=ifCallbacks.concat(),r=0;t=n[r++];)t(e)===!1&&avalon.Array.remove(ifCallbacks,t)})}var bindingHandlers=avalon.bindingHandlers={"if":function(e,t,n){function r(e){return(e?e.target==s:root.contains(s))?(clearInterval(c),a(),avalon(s).removeClass("fixMsIfFlicker"),!1):void 0}function a(){o=s.parentNode,updateViewFactory(e.value,t,e,function(e){if(e){if(!root.contains(s))try{o.replaceChild(s,i),delete l.sourceIndex}catch(t){}avalon.nextTick(n)}else root.contains(s)&&(o.replaceChild(i,s),l.sourceIndex=0)
})}n=n||avalon.noop;var o,i=DOC.createComment("@"),s=e.element,l=e.state;if(root.contains(s))a();else if(avalon(s).addClass("fixMsIfFlicker"),ifCallbacks)ifCallbacks.push(r);else var c=setInterval(r,20)},attr:function(e,t){updateViewFactory(e.value,t,e,function(t,n){var r=e.param,a=t===!1||null===t||void 0===t;a&&n.removeAttribute(r),fuckIEAttr&&r in propMap?(r=propMap[r],a?n.removeAttribute(r):n[r]=t):a||n.setAttribute(r,t)})},on:function(e,t){e.type="on";var n,r=e.value,a="$event",o=e.element,i=e.param;if(r.indexOf("(")>0&&r.indexOf(")")>-1){var s=(r.match(rdash)||["",""])[1].trim();(""===s||"$event"===s)&&(a=void 0,r=r.replace(rdash,""))}else a=void 0;var l=parseExpr(r,t,e,a);if(l){var c=l[0],u=l[1];n=a?function(e){return c.apply(this,u.concat(e))}:c.apply(c,u),o.$vmodels||(o.$vmodel=t[0],o.$vmodels=t),i&&"function"==typeof n&&avalon.bind(o,i,n)}},data:function(e,t){updateViewFactory(e.value,t,e,function(t,n){var r="data-"+e.param;t&&"object"==typeof t?n[r]=t:n.setAttribute(r,String(t))})},text:function(e,t){var n=e.node;updateViewFactory(e.value,t,e,function(e,t){2===n.nodeType?"textContent"in t?t.textContent=e:t.innerText=e:n.nodeValue=e})},visible:function(e,t){var n=e.element;if(!supportDisplay&&!root.contains(n))var r=parseDisplay(n.tagName);r=r||avalon(n).css("display"),r="none"===r?parseDisplay(n.tagName):r,updateViewFactory(e.value,t,e,function(e,t){t.style.display=e?r:"none"})},href:function(e,t){var n=e.value.trim(),r=!0,a=e.type;n.indexOf(openTag)>-1&&n.indexOf(closeTag)>2&&(r=!1,rexpr.test(n)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(r=!0,n=RegExp.$1)),updateViewFactory(n,t,e,function(n,r){if("css"===a)avalon(r).css(e.param,n);else if("include"===a&&n)if("src"===e.param){var o=new(window.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP");o.onreadystatechange=function(){if(4===o.readyState){var n=o.status;(n>=200&&300>n||304===n||1223===n)&&(avalon.innerHTML(r,o.responseText),scanNodes(r,t,e.state))}},o.open("GET",n,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.send(null)}else{var i=DOC.getElementById(n);avalon.nextTick(function(){i&&avalon.innerHTML(r,i.innerHTML),scanNodes(r,t,e.state)})}else r[a]=n},r?null:scanExpr(e.value))},disabled:function(e,t){var n=e.type,r="readonly"===n?"readOnly":n;updateViewFactory(e.value,t,e,function(e,t){t[r]=!!e})},bind:function(e,t){var n=e.value.match(/([$\w]+)\s*\:\s*([$\w]+)/);if(delete e.remove,n&&n[1]&&n[2]){for(var r,a=n[2],o=e.element,i=0;r=t[i++];)if(r.hasOwnProperty(a)){a=r[a];break}"function"==typeof a&&(a.call(o),r.$watch(n[1],function(e,t){a.call(o,e,t)}),e.remove=!0)}},html:function(e,t){updateViewFactory(e.value,t,e,function(t,n){if(t=null==t?"":t+"",e.replaceNodes){var r=avalon.parseHTML(t),a=avalon.slice(r.childNodes);n.insertBefore(r,e.replaceNodes[0]||null);for(var o,i=0;o=e.replaceNodes[i++];)n.removeChild(o);e.replaceNodes=a}else avalon.innerHTML(n,t)})},"with":function(e,t){bindingHandlers.each(e,t,!0)},ui:function(e,t,n){var r=e.value.trim(),a=e.element,o=(a.getAttribute("data-id")||"").trim();if(o||(o=r+setTimeout("1"),a.setAttribute("data-id",o)),a[o+"vmodels"]=t,"function"==typeof avalon.ui[r]){var i=e.param;if(i)for(var s,l=0;s=t[l++];)if(s.hasOwnProperty(i)){n=s.$model[i];break}avalon.ui[r](a,o,t,n||{});try{delete a[o+"vmodels"]}catch(c){a[o+"vmodels"]=void 0}}else delete e.remove}};"class,hover,active".replace(rword,function(e){bindingHandlers[e]=function(t,n){var r,a,o=t.param,i=t.element,s=avalon(i);if(!o||isFinite(o)){var l=t.value,c=l.replace(rexprg,function(e){return Math.pow(10,e.length-1)}),u=c.indexOf(":");if(-1===u)var p,f=l;else{f=l.slice(0,u),p=l.slice(u+1);var d=parseExpr(p,n,{});if(!Array.isArray(d))return log("'"+(p||"").trim()+"' 不存在于VM中"),!1;var g=d[0],h=d[1]}var v=rexpr.test(f);if(updateViewFactory("",n,t,function(t){r=g?!!g.apply(i,h):!0,f=v?t:f,"class"===e&&(r&&a&&s.removeClass(a),s.toggleClass(f,r),a=f)},v?scanExpr(f):null),"hover"===e||"active"===e){if("hover"===e)var m="mouseenter",y="mouseleave";else i.tabIndex=i.tabIndex||-1,m="mousedown",y="mouseup";s.bind(m,function(){r&&s.addClass(f)}),s.bind(y,function(){r&&s.removeClass(f)})}}else"class"===e&&updateViewFactory(t.value,n,t,function(e){s.toggleClass(o,!!e)})}}),"checked,readonly,selected".replace(rword,function(e){bindingHandlers[e]=bindingHandlers.disabled}),bindingHandlers.enabled=function(e,t){updateViewFactory(e.value,t,e,function(e,t){t.disabled=!e})},"title,alt,src,value,css,include".replace(rword,function(e){bindingHandlers[e]=bindingHandlers.href});var modelBinding=bindingHandlers.duplex=bindingHandlers.model=function(e,t){var n=e.element,r=n.tagName;if("model"===e.type&&log("ms-model已经被废弃，请使用ms-duplex"),"function"==typeof modelBinding[r]){var a=parseExpr(e.value,t,e,"setget");if(a){for(var o,i=e.value.split("."),s=i[0],l=i[1],c=t.length-1;o=t[c--];)if(o.hasOwnProperty(s)){if(!l||!o[s])break;if(o[s].hasOwnProperty(l))break}n.name||(n.name=generateID());var u=modelBinding[r](e,a[0],o);u&&registerSubscriber(u,e)}}};modelBinding.INPUT=function(e,t,n){function r(){a.beforeChecked=a.checked}var a=e.element,o=e.param,i=a.type,s=avalon(a);"checkbox"===i&&"radio"===o&&(i="radio");var l=function(){s.data("observe")!==!1&&t(n,a.value)},c=function(){var e=t(n);e!==a.value&&(a.value=e)};if(/^(password|textarea|text|url|email|date|month|time|week|number)$/.test(i)){var u=a.attributes["data-event"]||{};if(u=u.value,"change"===u)avalon.bind(a,u,l);else if(window.addEventListener?a.addEventListener("input",l):a.attachEvent("onpropertychange",function(e){"value"===e.propertyName&&l()}),9===DOC.documentMode){var p=function(e){"focus"===e.type?document.addEventListener("selectionchange",l):document.removeEventListener("selectionchange",l)};a.addEventListener("focus",p),a.addEventListener("blur",p)}}else"radio"===i?(c=function(){a.checked="text"===o?t(n)===a.value:!!t(n)},l=function(){if(s.data("observe")!==!1)if("text"===o)a.checked&&t(n,a.value);else{var e=!a.beforeChecked;t(n,e),a.beforeChecked=a.checked=e}},null===a.onbeforeactivate?s.bind("beforeactivate",r):s.bind("mouseover",r),s.bind("click",l)):"checkbox"===i&&(l=function(){if(s.data("observe")!==!1){var e=a.checked?"ensure":"remove";avalon.Array[e](t(n),a.value)}},c=function(){var e=[].concat(t(n));try{a.checked=e.indexOf(a.value)>=0}catch(r){log("<input type='checkbox' ms-duplex='prop' /> 中prop应为一个数组")}},s.bind("click",l));return c},modelBinding.SELECT=function(e,t,n,r){function a(){if(i.data("observe")!==!1){var e=i.val();e+""!==r&&(t(n,e),r=e+"")}}function o(){var e=t(n);e=Array.isArray(e)?e.map(String):e+"",e+""!==r&&(i.val(e),r=e+"")}var i=avalon(e.element);i.bind("change",a),setTimeout(function(){registerSubscriber(o,e)})},modelBinding.TEXTAREA=modelBinding.INPUT;var eventName={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};for(var name in eventName)if(/object|function/.test(typeof window[name])){eventMap.animationend=eventName[name];break}if("dblclick,mouseout,click,mouseover,mouseenter,mouseleave,mousemove,mousedown,mouseup,keypress,keydown,keyup,blur,focus,change,animationend".replace(rword,function(e){bindingHandlers[e]=function(t){t.param=e,bindingHandlers.on.apply(0,arguments)}}),!("onmouseenter"in root)){var oldBind=avalon.bind,events={mouseenter:"mouseover",mouseleave:"mouseout"};avalon.bind=function(e,t,n){return events[t]?oldBind(e,events[t],function(r){var a=r.relatedTarget;return a&&(a===e||16&e.compareDocumentPosition(a))?void 0:(delete r.type,r.type=t,n.call(e,r))}):oldBind(e,t,n)}}var _splice=[].splice,CollectionPrototype={_splice:_splice,_add:function(e,t){var n=this.length;t="number"==typeof t?t:n;for(var r=[],a=0,o=e.length;o>a;a++)r[a]=convert(e[a]);return _splice.apply(this,[t,0].concat(r)),notifySubscribers(this,"add",r,t),this._stopFireLength?void 0:this._.length=this.length},_del:function(e,t){var n=this._splice(e,t);return n.length&&(notifySubscribers(this,"del",e,t),this._stopFireLength||(this._.length=this.length)),n},push:function(){return[].push.apply(this.$model,arguments),this._add(arguments)},unshift:function(){[].unshift.apply(this.$model,arguments);var e=this._add(arguments,0);return notifySubscribers(this,"index",arguments.length),e},shift:function(){var e=this.$model.shift();return this._del(0,1),notifySubscribers(this,"index",0),e},pop:function(){var e=this.$model.pop();return this._del(this.length-1,1),e},splice:function(e){e=resetNumber(e,this.length);var t=_splice.apply(this.$model,arguments),n=[];return this._stopFireLength=!0,t.length&&(n=this._del(e,t.length),arguments.length<=2&&notifySubscribers(this,"index",0)),arguments.length>2&&this._add(aslice.call(arguments,2),e),this._stopFireLength=!1,this._.length=this.length,n},contains:function(e){return-1!==this.indexOf(e)},size:function(){return this._.length},remove:function(e){var t=this.indexOf(e);return t>=0?this.removeAt(t):void 0},removeAt:function(e){this.splice(e,1)},clear:function(){return this.$model.length=this.length=this._.length=0,notifySubscribers(this,"clear"),this},removeAll:function(e){if(Array.isArray(e))e.forEach(function(e){this.remove(e)},this);else if("function"==typeof e)for(var t=this.length-1;t>=0;t--){var n=this[t];e(n,t)&&this.splice(t,1)}else this.clear()},ensure:function(e){return this.contains(e)||this.push(e),this},set:function(e,t){if(e>=0&&e<this.length){var n=getType(t);rchecktype.test(n)?(t.$model&&(t=t.$model),updateViewModel(this[e],t,n)):this[e]!==t&&(this[e]=t,notifySubscribers(this,"set",e,t))}return this}};"sort,reverse".replace(rword,function(e){CollectionPrototype[e]=function(){[][e].apply(this.$model,arguments);for(var t=!1,n=0,r=this.length;r>n;n++){var a=this.$model[n],o=this[n];if(o=o&&o.$model?o.$model:o,!isEqual(a,o)){t=!0;var i=getVMIndex(a,this,n),s=this._splice(i,1)[0];this._splice(n,0,s),notifySubscribers(this,"move",i,n)}}return t&&notifySubscribers(this,"index",0),this}});var withMapper={};bindingHandlers.each=function(e,t){var n,r,a=e.element,o=parseExpr(e.value,t,e);"object"==typeof o&&(n=o[0].apply(o[0],o[1]));for(var i=documentFragment.cloneNode(!1);a.firstChild;)i.appendChild(a.firstChild);return e.template=i,e.vmodels=t,"object"!=typeof n?n:(Array.isArray(n)?(e.mapper=[],r=function(t,n,a){eachIterator(t,n,a,e,r.host)}):(e.markstone={},r=function(t,n,a){withIterator(t,n,a,e,r.host)}),r.element=a,r.state=e.state,r.host=n,n[subscribers]&&n[subscribers].push(r),r("add",n,0),void 0)};var watchEachOne=oneObject("$index,$remove,$first,$last"),filters=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){return t=t||30,n=void 0===n?"...":n,e.length>t?e.slice(0,t-n.length)+n:String(e)},camelize:camelize,escape:function(e){return String(e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},currency:function(e,t){return t=t||"￥",t+avalon.filters.number(e)},number:function(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,i=r||",",s=n||".",l="",c=function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n};return l=(o?c(a,o):""+Math.round(a)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(l[1]||"").length<o&&(l[1]=l[1]||"",l[1]+=new Array(o-l[1].length+1).join("0")),l.join(s)}};new function(){function e(e){return parseInt(e,10)}function t(e,t,n){var r="";for(0>e&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function n(e,n,r,a){return function(o){var i=o["get"+e]();return(r>0||i>-r)&&(i+=r),0===i&&-12===r&&(i=12),t(i,n,a)}}function r(e,t){return function(n,r){var a=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return r[o][a]}}function a(e){var n=-1*e.getTimezoneOffset(),r=n>=0?"+":"";return r+=t(Math[n>0?"floor":"ceil"](n/60),2)+t(Math.abs(n%60),2)}function o(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function i(t){var n;if(n=t.match(u)){var r=new Date(0),a=0,o=0,i=n[8]?r.setUTCFullYear:r.setFullYear,s=n[8]?r.setUTCHours:r.setHours;n[9]&&(a=e(n[9]+n[10]),o=e(n[9]+n[11])),i.call(r,e(n[1]),e(n[2])-1,e(n[3]));var l=e(n[4]||0)-a,c=e(n[5]||0)-o,p=e(n[6]||0),f=Math.round(1e3*parseFloat("0."+(n[7]||0)));return s.call(r,l,c,p,f),r}return t}var s={yyyy:n("FullYear",4),yy:n("FullYear",2,0,!0),y:n("FullYear",1),MMMM:r("Month"),MMM:r("Month",!0),MM:n("Month",2,1),M:n("Month",1,1),dd:n("Date",2),d:n("Date",1),HH:n("Hours",2),H:n("Hours",1),hh:n("Hours",2,-12),h:n("Hours",1,-12),mm:n("Minutes",2),m:n("Minutes",1),ss:n("Seconds",2),s:n("Seconds",1),sss:n("Milliseconds",3),EEEE:r("Day"),EEE:r("Day",!0),a:o,Z:a},l=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,c=/^\d+$/,u=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;filters.date=function(t,n){var r,a,o=filters.date.locate,u="",p=[];if(n=n||"mediumDate",n=o[n]||n,"string"==typeof t&&(t=c.test(t)?e(t):i(t),t=new Date(t)),"number"==typeof t&&(t=new Date(t)),"date"===getType(t)){for(;n;)a=l.exec(n),a?(p=p.concat(a.slice(1)),n=p.pop()):(p.push(n),n=null);return p.forEach(function(e){r=s[e],u+=r?r(t,o):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}};var p={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};p.SHORTMONTH=p.MONTH,filters.date.locate=p};var innerRequire,modules=avalon.modules={"ready!":{exports:avalon},avalon:{exports:avalon,state:2}};new function(){function e(e){return(e||"").replace(/[?#].*/,"")}function t(e){var t;try{a.b.c()}catch(n){t=n.stack,!t&&window.opera&&(t=(String(n).match(/of linked script \S+/g)||[]).join(" "))}if(t)return t=t.split(/[@ ]/g).pop(),t="("===t[0]?t.slice(1,-1):t.replace(/\s/,""),t.replace(/(:\d+)?:\d+$/i,"");for(var r,o=(e?DOC:head).getElementsByTagName("script"),i=o.length;r=o[--i];)if((e||r.className===subscribers)&&"interactive"===r.readyState)return r.className=r.src}function n(e,t){for(var r in e)if("司徒正美"===e[r]&&2!==modules[r].state&&(r===t||n(modules[r].deps,t)))return!0}function r(){e:for(var e,t=u.length;e=u[--t];){var n=modules[e],a=n.deps;for(var o in a)if(ohasOwn.call(a,o)&&2!==modules[o].state)continue e;2!==n.state&&(u.splice(t,1),l(n.id,n.args,n.factory),r())}}function o(t,n,r){var a=e(t.src);return t.onload=t.onreadystatechange=t.onerror=null,n||r&&!modules[a].state?(setTimeout(function(){head.removeChild(t),t=null}),log("加载 "+a+" 失败"+n+" "+!modules[a].state),void 0):!0}function i(t,n,r,a){if("ready!"===t||modules[t]&&2===modules[t].state)return t;kernel.alias[t]&&(t=kernel.alias[t],"object"==typeof t&&(a=t,t=t.src));var o;if(t=t.replace(/^\w+!/,function(e){return o=e.slice(0,-1),""}),o=o||"js",o=plugins[o]||noop,/^(\w+)(\d)?:.*/.test(t))r=t;else{n=n.substr(0,n.lastIndexOf("/"));var i=t.charAt(0);if("."!==i&&"/"!==i)r=c+t;else if("./"===t.slice(0,2))r=n+t.slice(1);else if(".."===t.slice(0,2)){var s=n.replace(/\/$/,"").split("/");i=t.replace(/\.\.\//g,function(){return s.pop(),""}),r=s.join("/")+"/"+i}else"/"===i?r=n+t:avalon.error("不符合模块标识规则: "+t)}t=e(r);var l=o.ext;return l&&t.slice(0-l.length)!==l&&(r+=l),kernel.nocache&&(r+=(-1===r.indexOf("?")?"?":"&")+(new Date-0)),o(r,a)}function s(e,t,n){var r=DOC.createElement("script");r.className=subscribers,r[W3C?"onload":"onreadystatechange"]=function(){if(W3C||/loaded|complete/i.test(r.readyState)){var a=p.pop();a&&a.delay(t),n&&n(),o(r,!1,!W3C)&&log("已成功加载 "+e)}},r.onerror=function(){o(r,!0)},r.src=e,head.insertBefore(r,head.firstChild),log("正准备加载 "+e)}function l(e,t,n){for(var r,a=0,o=[];r=t[a++];)o.push(modules[r].exports);var i=Object(modules[e]),s=n.apply(window,o);return i.state=2,void 0!==s&&(modules[e].exports=s),s}var c,u=[],p=[];plugins.js=function(t,n){var r=e(t);return modules[r]||(modules[r]={id:r,parent:parent,exports:{}},n?innerRequire(n.deps||"",function(){s(t,r,function(){modules[r].state=2,n.exports&&(modules[r].exports="function"==typeof n.exports?n.exports():window[n.exports]),innerRequire.checkDeps()})}):s(t,r)),r},plugins.css=function(e){var t=e.replace(/(#.+|\W)/g,"");if(!DOC.getElementById(t)){var n=DOC.createElement("link");n.rel="stylesheet",n.href=e,n.id=t,head.insertBefore(n,head.firstChild)}},plugins.css.ext=".css",plugins.js.ext=".js";var f=t(!0);f||(f=avalon.slice(document.scripts).pop().src);var d=e(f);c=kernel.base=d.slice(0,d.lastIndexOf("/")+1),innerRequire=avalon.require=function(e,t,n){var a={},o=[],s=0,p=0,f=n||"callback"+setTimeout("1");n=n||c,String(e).replace(rword,function(e){var t=i(e,n);t&&(s++,modules[t]&&2===modules[t].state&&p++,a[t]||(o.push(t),a[t]="司徒正美"))}),modules[f]={id:f,factory:t,deps:a,args:o,state:1},s===p?l(f,o,t):u.unshift(f),r()},innerRequire.define=function(r,a,o){var i=aslice.call(arguments);if("string"==typeof r)var s=i.shift();if("boolean"==typeof i[0]){if(i[0])return;i.shift()}"function"==typeof i[0]&&i.unshift([]);var l=modules[s]&&modules[s].state>=1?s:e(t());!modules[l]&&s&&(modules[l]={id:l,factory:o,state:1}),o=i[1],o.id=s,o.delay=function(e){i.push(e);var t=!0;try{t=n(modules[e].deps,e)}catch(r){}t&&avalon.error(e+"模块与之前的某些模块存在循环依赖"),delete o.delay,innerRequire.apply(null,i)},l?o.delay(l,i):p.push(o)},innerRequire.define.amd=modules,innerRequire.config=kernel,innerRequire.checkDeps=r};var ready=W3C?"DOMContentLoaded":"readystatechange";"complete"===DOC.readyState?fireReady():W3C?DOC.addEventListener(ready,function(){fireReady()}):(DOC.attachEvent("onreadystatechange",function(){"complete"===DOC.readyState&&fireReady()}),root.doScroll&&doScrollCheck()),avalon.ready=function(e){innerRequire("ready!",e)},avalon.config({loader:!0}),avalon.ready(function(){avalon.scan(document.body)})}(document),avalon.config({loader:!1}),avalon.filters.richText=function(e){return e.replace(/\r?\n/gi,"<br/>").replace(/ |  /gi,"&nbsp;")};var titlRegForAvalonFilter=/#+.+\n+/;avalon.filters.removeSummeryTitle=function(e){return e.replace(titlRegForAvalonFilter,"")},avalon.filters.md2html=function(e){return Converter.makeHtml(e)},avalon.filters.md2head=function(e){return e.replace(/^#+/,"")},avalon.filters.addSyntexType=function(e){var t=e.split("<pre><code>$"),n=t.length;if(n>1)for(var r=0;n>r+1;r++){var a=t[r+1].indexOf("$"),o=t[r+1].substr(0,a);t[r]+='<pre><code class="language-'+o+'">',t[r+1]=t[r+1].substr(a+1,t[r+1].length),t[r+1]=t[r+1].replace(/\n/,"")}return t.join("")};